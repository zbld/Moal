2025-11-07 20:45:10,309 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-07 20:45:10,309 [trainer.py] => prefix: reproduce
2025-11-07 20:45:10,309 [trainer.py] => dataset: cifar224
2025-11-07 20:45:10,309 [trainer.py] => memory_size: 0
2025-11-07 20:45:10,309 [trainer.py] => memory_per_class: 0
2025-11-07 20:45:10,309 [trainer.py] => fixed_memory: False
2025-11-07 20:45:10,309 [trainer.py] => shuffle: True
2025-11-07 20:45:10,309 [trainer.py] => init_cls: 20
2025-11-07 20:45:10,309 [trainer.py] => increment: 20
2025-11-07 20:45:10,309 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-07 20:45:10,309 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-07 20:45:10,309 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-07 20:45:10,310 [trainer.py] => seed: 1993
2025-11-07 20:45:10,310 [trainer.py] => Hidden: 5000
2025-11-07 20:45:10,310 [trainer.py] => rg: 0.1
2025-11-07 20:45:10,310 [trainer.py] => lambda_fkd: 1
2025-11-07 20:45:10,310 [trainer.py] => cali_weight: 1.0
2025-11-07 20:45:10,310 [trainer.py] => alpha: 0.999
2025-11-07 20:45:10,310 [trainer.py] => tuned_epoch: 80
2025-11-07 20:45:10,310 [trainer.py] => progreesive_epoch: 80
2025-11-07 20:45:10,310 [trainer.py] => init_lr: 0.01
2025-11-07 20:45:10,310 [trainer.py] => progressive_lr: 0.01
2025-11-07 20:45:10,310 [trainer.py] => batch_size: 48
2025-11-07 20:45:10,310 [trainer.py] => weight_decay: 0.0005
2025-11-07 20:45:10,310 [trainer.py] => min_lr: 0
2025-11-07 20:45:10,310 [trainer.py] => ffn_num: 64
2025-11-07 20:45:10,310 [trainer.py] => optimizer: sgd
2025-11-07 20:45:10,310 [trainer.py] => vpt_type: shallow
2025-11-07 20:45:10,310 [trainer.py] => prompt_token_num: 5
2025-11-07 20:45:11,516 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-07 20:45:13,372 [trainer.py] => All params: 86988288
2025-11-07 20:45:13,372 [trainer.py] => Trainable params: 1189632
2025-11-07 20:45:13,372 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-20
2025-11-08 00:29:01,553 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.303, Train_accy 90.90, Test_accy 97.70
2025-11-08 00:32:19,814 [adapt_ac_com_sdc_EMA_auto.py] => gamma 10000.0
2025-11-08 00:32:40,348 [trainer.py] => No NME accuracy.
2025-11-08 00:32:40,349 [trainer.py] => CNN: {'total': 97.55, '00-19': 97.55, 'old': 0, 'new': 97.55}
2025-11-08 00:32:40,349 [trainer.py] => CNN top1 curve: [97.55]
2025-11-08 00:32:40,349 [trainer.py] => CNN top5 curve: [99.75]

2025-11-08 00:32:40,349 [trainer.py] => Average Accuracy (CNN): 97.55 

2025-11-08 00:32:40,349 [trainer.py] => All params: 90943649
2025-11-08 00:32:40,350 [trainer.py] => Trainable params: 5144993
2025-11-08 00:32:40,350 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 20-40
2025-11-08 04:41:14,261 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 80/80 => Loss 0.437, Train_accy 82.35, Test_accy 43.88
2025-11-08 04:46:00,549 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-08 04:49:49,026 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.042684504628181456
2025-11-08 04:54:02,526 [trainer.py] => No NME accuracy.
2025-11-08 04:54:02,526 [trainer.py] => CNN: {'total': 96.05, '00-19': 95.35, '20-39': 96.75, 'old': 95.35, 'new': 96.75}
2025-11-08 04:54:02,527 [trainer.py] => CNN top1 curve: [97.55, 96.05]
2025-11-08 04:54:02,527 [trainer.py] => CNN top5 curve: [99.75, 99.55]

2025-11-08 04:54:02,527 [trainer.py] => Average Accuracy (CNN): 96.8 

2025-11-08 04:54:02,527 [trainer.py] => All params: 91059009
2025-11-08 04:54:02,528 [trainer.py] => Trainable params: 1420353
2025-11-08 04:54:02,528 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 40-60
2025-11-08 09:32:19,318 [adapt_ac_com_sdc_EMA_auto.py] => Task 2, Epoch 80/80 => Loss 0.323, Train_accy 90.60, Test_accy 43.73
2025-11-08 09:37:12,049 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-08 09:41:18,048 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04387707132101059
2025-11-08 09:45:52,516 [trainer.py] => No NME accuracy.
2025-11-08 09:45:52,516 [trainer.py] => CNN: {'total': 94.1, '00-19': 93.55, '20-39': 94.2, '40-59': 94.55, 'old': 93.88, 'new': 94.55}
2025-11-08 09:45:52,516 [trainer.py] => CNN top1 curve: [97.55, 96.05, 94.1]
2025-11-08 09:45:52,516 [trainer.py] => CNN top5 curve: [99.75, 99.55, 99.38]

2025-11-08 09:45:52,516 [trainer.py] => Average Accuracy (CNN): 95.89999999999999 

2025-11-08 09:45:52,517 [trainer.py] => All params: 91174369
2025-11-08 09:45:52,517 [trainer.py] => Trainable params: 1535713
2025-11-08 09:45:52,517 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 60-80
2025-11-08 14:48:15,847 [adapt_ac_com_sdc_EMA_auto.py] => Task 3, Epoch 80/80 => Loss 0.492, Train_accy 81.46, Test_accy 37.92
2025-11-08 14:53:06,046 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-08 14:57:14,251 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.0462303064763546
2025-11-08 15:02:14,206 [trainer.py] => No NME accuracy.
2025-11-08 15:02:14,207 [trainer.py] => CNN: {'total': 92.04, '00-19': 92.5, '20-39': 93.95, '40-59': 89.9, '60-79': 91.8, 'old': 92.12, 'new': 91.8}
2025-11-08 15:02:14,207 [trainer.py] => CNN top1 curve: [97.55, 96.05, 94.1, 92.04]
2025-11-08 15:02:14,207 [trainer.py] => CNN top5 curve: [99.75, 99.55, 99.38, 99.19]

2025-11-08 15:02:14,207 [trainer.py] => Average Accuracy (CNN): 94.935 

2025-11-08 15:02:14,207 [trainer.py] => All params: 91289729
2025-11-08 15:02:14,208 [trainer.py] => Trainable params: 1651073
2025-11-08 15:02:14,208 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 80-100
2025-11-08 20:29:34,071 [adapt_ac_com_sdc_EMA_auto.py] => Task 4, Epoch 80/80 => Loss 0.500, Train_accy 82.34, Test_accy 34.06
2025-11-08 20:34:25,910 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-08 20:38:25,262 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.0485093524903059
2025-11-08 20:43:52,183 [trainer.py] => No NME accuracy.
2025-11-08 20:43:52,183 [trainer.py] => CNN: {'total': 91.03, '00-19': 91.55, '20-39': 92.9, '40-59': 87.45, '60-79': 90.25, '80-99': 93.0, 'old': 90.54, 'new': 93.0}
2025-11-08 20:43:52,184 [trainer.py] => CNN top1 curve: [97.55, 96.05, 94.1, 92.04, 91.03]
2025-11-08 20:43:52,184 [trainer.py] => CNN top5 curve: [99.75, 99.55, 99.38, 99.19, 98.84]

2025-11-08 20:43:52,184 [trainer.py] => Average Accuracy (CNN): 94.154 

2025-11-08 20:43:52,184 [trainer.py] => All History Accuracy (CNN): [[97.55], [95.35, 96.75], [93.55, 94.2, 94.55], [92.5, 93.95, 89.9, 91.8], [91.55, 92.9, 87.45, 90.25, 93.0]] 

