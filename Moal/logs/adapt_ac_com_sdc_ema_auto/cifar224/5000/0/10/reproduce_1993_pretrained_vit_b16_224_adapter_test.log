2025-11-04 11:28:30,959 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 11:28:30,959 [trainer.py] => prefix: reproduce
2025-11-04 11:28:30,959 [trainer.py] => dataset: cifar224
2025-11-04 11:28:30,959 [trainer.py] => memory_size: 0
2025-11-04 11:28:30,959 [trainer.py] => memory_per_class: 0
2025-11-04 11:28:30,959 [trainer.py] => fixed_memory: False
2025-11-04 11:28:30,959 [trainer.py] => shuffle: True
2025-11-04 11:28:30,959 [trainer.py] => init_cls: 10
2025-11-04 11:28:30,960 [trainer.py] => increment: 10
2025-11-04 11:28:30,960 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 11:28:30,960 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 11:28:30,960 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-04 11:28:30,960 [trainer.py] => seed: 1993
2025-11-04 11:28:30,960 [trainer.py] => Hidden: 5000
2025-11-04 11:28:30,960 [trainer.py] => rg: 0.1
2025-11-04 11:28:30,960 [trainer.py] => lambda_fkd: 1
2025-11-04 11:28:30,960 [trainer.py] => cali_weight: 1.0
2025-11-04 11:28:30,960 [trainer.py] => alpha: 0.999
2025-11-04 11:28:30,960 [trainer.py] => tuned_epoch: 80
2025-11-04 11:28:30,960 [trainer.py] => progreesive_epoch: 80
2025-11-04 11:28:30,960 [trainer.py] => init_lr: 0.01
2025-11-04 11:28:30,960 [trainer.py] => progressive_lr: 0.01
2025-11-04 11:28:30,960 [trainer.py] => batch_size: 48
2025-11-04 11:28:30,960 [trainer.py] => weight_decay: 0.0005
2025-11-04 11:28:30,960 [trainer.py] => min_lr: 0
2025-11-04 11:28:30,960 [trainer.py] => ffn_num: 64
2025-11-04 11:28:30,960 [trainer.py] => optimizer: sgd
2025-11-04 11:28:30,960 [trainer.py] => vpt_type: shallow
2025-11-04 11:28:30,960 [trainer.py] => prompt_token_num: 5
2025-11-04 11:28:32,159 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 11:28:33,698 [hub.py] => Downloading: "https://storage.googleapis.com/vit_models/augreg/B_16-i21k-300ep-lr_0.001-aug_medium1-wd_0.1-do_0.0-sd_0.0--imagenet2012-steps_20k-lr_0.01-res_224.npz" to /home/shihan/.cache/torch/hub/checkpoints/B_16-i21k-300ep-lr_0.001-aug_medium1-wd_0.1-do_0.0-sd_0.0--imagenet2012-steps_20k-lr_0.01-res_224.npz

2025-11-04 11:30:51,754 [trainer.py] => All params: 86988288
2025-11-04 11:30:51,755 [trainer.py] => Trainable params: 1189632
2025-11-04 11:30:51,755 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 11:48:52,737 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 11:48:52,737 [trainer.py] => prefix: reproduce
2025-11-04 11:48:52,737 [trainer.py] => dataset: cifar224
2025-11-04 11:48:52,737 [trainer.py] => memory_size: 0
2025-11-04 11:48:52,737 [trainer.py] => memory_per_class: 0
2025-11-04 11:48:52,737 [trainer.py] => fixed_memory: False
2025-11-04 11:48:52,737 [trainer.py] => shuffle: True
2025-11-04 11:48:52,737 [trainer.py] => init_cls: 10
2025-11-04 11:48:52,737 [trainer.py] => increment: 10
2025-11-04 11:48:52,737 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 11:48:52,737 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 11:48:52,737 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-04 11:48:52,737 [trainer.py] => seed: 1993
2025-11-04 11:48:52,737 [trainer.py] => Hidden: 5000
2025-11-04 11:48:52,737 [trainer.py] => rg: 0.1
2025-11-04 11:48:52,737 [trainer.py] => lambda_fkd: 1
2025-11-04 11:48:52,737 [trainer.py] => cali_weight: 1.0
2025-11-04 11:48:52,738 [trainer.py] => alpha: 0.999
2025-11-04 11:48:52,738 [trainer.py] => tuned_epoch: 80
2025-11-04 11:48:52,738 [trainer.py] => progreesive_epoch: 80
2025-11-04 11:48:52,738 [trainer.py] => init_lr: 0.01
2025-11-04 11:48:52,738 [trainer.py] => progressive_lr: 0.01
2025-11-04 11:48:52,738 [trainer.py] => batch_size: 48
2025-11-04 11:48:52,738 [trainer.py] => weight_decay: 0.0005
2025-11-04 11:48:52,738 [trainer.py] => min_lr: 0
2025-11-04 11:48:52,738 [trainer.py] => ffn_num: 64
2025-11-04 11:48:52,738 [trainer.py] => optimizer: sgd
2025-11-04 11:48:52,738 [trainer.py] => vpt_type: shallow
2025-11-04 11:48:52,738 [trainer.py] => prompt_token_num: 5
2025-11-04 11:48:53,937 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 11:48:55,796 [trainer.py] => All params: 86988288
2025-11-04 11:48:55,796 [trainer.py] => Trainable params: 1189632
2025-11-04 11:48:55,797 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 11:51:19,792 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 11:51:19,793 [trainer.py] => prefix: reproduce
2025-11-04 11:51:19,793 [trainer.py] => dataset: cifar224
2025-11-04 11:51:19,793 [trainer.py] => memory_size: 0
2025-11-04 11:51:19,793 [trainer.py] => memory_per_class: 0
2025-11-04 11:51:19,793 [trainer.py] => fixed_memory: False
2025-11-04 11:51:19,793 [trainer.py] => shuffle: True
2025-11-04 11:51:19,793 [trainer.py] => init_cls: 10
2025-11-04 11:51:19,793 [trainer.py] => increment: 10
2025-11-04 11:51:19,793 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 11:51:19,793 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 11:51:19,793 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-04 11:51:19,793 [trainer.py] => seed: 1993
2025-11-04 11:51:19,793 [trainer.py] => Hidden: 5000
2025-11-04 11:51:19,793 [trainer.py] => rg: 0.1
2025-11-04 11:51:19,793 [trainer.py] => lambda_fkd: 1
2025-11-04 11:51:19,793 [trainer.py] => cali_weight: 1.0
2025-11-04 11:51:19,793 [trainer.py] => alpha: 0.999
2025-11-04 11:51:19,793 [trainer.py] => tuned_epoch: 80
2025-11-04 11:51:19,793 [trainer.py] => progreesive_epoch: 80
2025-11-04 11:51:19,793 [trainer.py] => init_lr: 0.01
2025-11-04 11:51:19,793 [trainer.py] => progressive_lr: 0.01
2025-11-04 11:51:19,793 [trainer.py] => batch_size: 48
2025-11-04 11:51:19,793 [trainer.py] => weight_decay: 0.0005
2025-11-04 11:51:19,793 [trainer.py] => min_lr: 0
2025-11-04 11:51:19,793 [trainer.py] => ffn_num: 64
2025-11-04 11:51:19,793 [trainer.py] => optimizer: sgd
2025-11-04 11:51:19,793 [trainer.py] => vpt_type: shallow
2025-11-04 11:51:19,793 [trainer.py] => prompt_token_num: 5
2025-11-04 11:51:20,997 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 11:51:22,854 [trainer.py] => All params: 86988288
2025-11-04 11:51:22,854 [trainer.py] => Trainable params: 1189632
2025-11-04 11:51:22,854 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 13:43:13,606 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.174, Train_accy 94.80, Test_accy 99.10
2025-11-04 13:44:54,227 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-04 13:45:05,265 [trainer.py] => No NME accuracy.
2025-11-04 13:45:05,266 [trainer.py] => CNN: {'total': 98.9, '00-09': 98.9, 'old': 0, 'new': 98.9}
2025-11-04 13:45:05,266 [trainer.py] => CNN top1 curve: [98.9]
2025-11-04 13:45:05,266 [trainer.py] => CNN top5 curve: [100.0]

2025-11-04 13:45:05,266 [trainer.py] => Average Accuracy (CNN): 98.9 

2025-11-04 13:45:05,266 [trainer.py] => All params: 90885969
2025-11-04 13:45:05,267 [trainer.py] => Trainable params: 5087313
2025-11-04 13:45:05,267 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-04 14:53:25,916 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 14:53:25,916 [trainer.py] => prefix: reproduce
2025-11-04 14:53:25,916 [trainer.py] => dataset: cifar224
2025-11-04 14:53:25,916 [trainer.py] => memory_size: 0
2025-11-04 14:53:25,916 [trainer.py] => memory_per_class: 0
2025-11-04 14:53:25,916 [trainer.py] => fixed_memory: False
2025-11-04 14:53:25,916 [trainer.py] => shuffle: True
2025-11-04 14:53:25,916 [trainer.py] => init_cls: 10
2025-11-04 14:53:25,916 [trainer.py] => increment: 10
2025-11-04 14:53:25,916 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 14:53:25,916 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 14:53:25,917 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 14:53:25,917 [trainer.py] => seed: 1993
2025-11-04 14:53:25,917 [trainer.py] => Hidden: 5000
2025-11-04 14:53:25,917 [trainer.py] => rg: 0.1
2025-11-04 14:53:25,917 [trainer.py] => lambda_fkd: 1
2025-11-04 14:53:25,917 [trainer.py] => cali_weight: 1.0
2025-11-04 14:53:25,917 [trainer.py] => alpha: 0.999
2025-11-04 14:53:25,917 [trainer.py] => tuned_epoch: 80
2025-11-04 14:53:25,917 [trainer.py] => progreesive_epoch: 80
2025-11-04 14:53:25,917 [trainer.py] => init_lr: 0.01
2025-11-04 14:53:25,917 [trainer.py] => progressive_lr: 0.01
2025-11-04 14:53:25,917 [trainer.py] => batch_size: 48
2025-11-04 14:53:25,917 [trainer.py] => weight_decay: 0.0005
2025-11-04 14:53:25,917 [trainer.py] => min_lr: 0
2025-11-04 14:53:25,917 [trainer.py] => ffn_num: 64
2025-11-04 14:53:25,917 [trainer.py] => optimizer: sgd
2025-11-04 14:53:25,917 [trainer.py] => vpt_type: shallow
2025-11-04 14:53:25,917 [trainer.py] => prompt_token_num: 5
2025-11-04 14:53:27,128 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 14:53:29,022 [trainer.py] => All params: 86988288
2025-11-04 14:53:29,023 [trainer.py] => Trainable params: 1189632
2025-11-04 14:53:29,023 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 14:59:54,074 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 14:59:54,074 [trainer.py] => prefix: reproduce
2025-11-04 14:59:54,074 [trainer.py] => dataset: cifar224
2025-11-04 14:59:54,074 [trainer.py] => memory_size: 0
2025-11-04 14:59:54,074 [trainer.py] => memory_per_class: 0
2025-11-04 14:59:54,074 [trainer.py] => fixed_memory: False
2025-11-04 14:59:54,074 [trainer.py] => shuffle: True
2025-11-04 14:59:54,074 [trainer.py] => init_cls: 10
2025-11-04 14:59:54,074 [trainer.py] => increment: 10
2025-11-04 14:59:54,074 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 14:59:54,074 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 14:59:54,074 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 14:59:54,074 [trainer.py] => seed: 1993
2025-11-04 14:59:54,074 [trainer.py] => Hidden: 5000
2025-11-04 14:59:54,075 [trainer.py] => rg: 0.1
2025-11-04 14:59:54,075 [trainer.py] => lambda_fkd: 1
2025-11-04 14:59:54,075 [trainer.py] => cali_weight: 1.0
2025-11-04 14:59:54,075 [trainer.py] => alpha: 0.999
2025-11-04 14:59:54,075 [trainer.py] => tuned_epoch: 80
2025-11-04 14:59:54,075 [trainer.py] => progreesive_epoch: 80
2025-11-04 14:59:54,075 [trainer.py] => init_lr: 0.01
2025-11-04 14:59:54,075 [trainer.py] => progressive_lr: 0.01
2025-11-04 14:59:54,075 [trainer.py] => batch_size: 48
2025-11-04 14:59:54,075 [trainer.py] => weight_decay: 0.0005
2025-11-04 14:59:54,075 [trainer.py] => min_lr: 0
2025-11-04 14:59:54,075 [trainer.py] => ffn_num: 64
2025-11-04 14:59:54,075 [trainer.py] => optimizer: sgd
2025-11-04 14:59:54,075 [trainer.py] => vpt_type: shallow
2025-11-04 14:59:54,075 [trainer.py] => prompt_token_num: 5
2025-11-04 14:59:55,282 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 14:59:57,176 [trainer.py] => All params: 86988288
2025-11-04 14:59:57,176 [trainer.py] => Trainable params: 1189632
2025-11-04 14:59:57,177 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
