2025-11-04 11:28:30,959 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 11:28:30,959 [trainer.py] => prefix: reproduce
2025-11-04 11:28:30,959 [trainer.py] => dataset: cifar224
2025-11-04 11:28:30,959 [trainer.py] => memory_size: 0
2025-11-04 11:28:30,959 [trainer.py] => memory_per_class: 0
2025-11-04 11:28:30,959 [trainer.py] => fixed_memory: False
2025-11-04 11:28:30,959 [trainer.py] => shuffle: True
2025-11-04 11:28:30,959 [trainer.py] => init_cls: 10
2025-11-04 11:28:30,960 [trainer.py] => increment: 10
2025-11-04 11:28:30,960 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 11:28:30,960 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 11:28:30,960 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-04 11:28:30,960 [trainer.py] => seed: 1993
2025-11-04 11:28:30,960 [trainer.py] => Hidden: 5000
2025-11-04 11:28:30,960 [trainer.py] => rg: 0.1
2025-11-04 11:28:30,960 [trainer.py] => lambda_fkd: 1
2025-11-04 11:28:30,960 [trainer.py] => cali_weight: 1.0
2025-11-04 11:28:30,960 [trainer.py] => alpha: 0.999
2025-11-04 11:28:30,960 [trainer.py] => tuned_epoch: 80
2025-11-04 11:28:30,960 [trainer.py] => progreesive_epoch: 80
2025-11-04 11:28:30,960 [trainer.py] => init_lr: 0.01
2025-11-04 11:28:30,960 [trainer.py] => progressive_lr: 0.01
2025-11-04 11:28:30,960 [trainer.py] => batch_size: 48
2025-11-04 11:28:30,960 [trainer.py] => weight_decay: 0.0005
2025-11-04 11:28:30,960 [trainer.py] => min_lr: 0
2025-11-04 11:28:30,960 [trainer.py] => ffn_num: 64
2025-11-04 11:28:30,960 [trainer.py] => optimizer: sgd
2025-11-04 11:28:30,960 [trainer.py] => vpt_type: shallow
2025-11-04 11:28:30,960 [trainer.py] => prompt_token_num: 5
2025-11-04 11:28:32,159 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 11:28:33,698 [hub.py] => Downloading: "https://storage.googleapis.com/vit_models/augreg/B_16-i21k-300ep-lr_0.001-aug_medium1-wd_0.1-do_0.0-sd_0.0--imagenet2012-steps_20k-lr_0.01-res_224.npz" to /home/shihan/.cache/torch/hub/checkpoints/B_16-i21k-300ep-lr_0.001-aug_medium1-wd_0.1-do_0.0-sd_0.0--imagenet2012-steps_20k-lr_0.01-res_224.npz

2025-11-04 11:30:51,754 [trainer.py] => All params: 86988288
2025-11-04 11:30:51,755 [trainer.py] => Trainable params: 1189632
2025-11-04 11:30:51,755 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 11:48:52,737 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 11:48:52,737 [trainer.py] => prefix: reproduce
2025-11-04 11:48:52,737 [trainer.py] => dataset: cifar224
2025-11-04 11:48:52,737 [trainer.py] => memory_size: 0
2025-11-04 11:48:52,737 [trainer.py] => memory_per_class: 0
2025-11-04 11:48:52,737 [trainer.py] => fixed_memory: False
2025-11-04 11:48:52,737 [trainer.py] => shuffle: True
2025-11-04 11:48:52,737 [trainer.py] => init_cls: 10
2025-11-04 11:48:52,737 [trainer.py] => increment: 10
2025-11-04 11:48:52,737 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 11:48:52,737 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 11:48:52,737 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-04 11:48:52,737 [trainer.py] => seed: 1993
2025-11-04 11:48:52,737 [trainer.py] => Hidden: 5000
2025-11-04 11:48:52,737 [trainer.py] => rg: 0.1
2025-11-04 11:48:52,737 [trainer.py] => lambda_fkd: 1
2025-11-04 11:48:52,737 [trainer.py] => cali_weight: 1.0
2025-11-04 11:48:52,738 [trainer.py] => alpha: 0.999
2025-11-04 11:48:52,738 [trainer.py] => tuned_epoch: 80
2025-11-04 11:48:52,738 [trainer.py] => progreesive_epoch: 80
2025-11-04 11:48:52,738 [trainer.py] => init_lr: 0.01
2025-11-04 11:48:52,738 [trainer.py] => progressive_lr: 0.01
2025-11-04 11:48:52,738 [trainer.py] => batch_size: 48
2025-11-04 11:48:52,738 [trainer.py] => weight_decay: 0.0005
2025-11-04 11:48:52,738 [trainer.py] => min_lr: 0
2025-11-04 11:48:52,738 [trainer.py] => ffn_num: 64
2025-11-04 11:48:52,738 [trainer.py] => optimizer: sgd
2025-11-04 11:48:52,738 [trainer.py] => vpt_type: shallow
2025-11-04 11:48:52,738 [trainer.py] => prompt_token_num: 5
2025-11-04 11:48:53,937 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 11:48:55,796 [trainer.py] => All params: 86988288
2025-11-04 11:48:55,796 [trainer.py] => Trainable params: 1189632
2025-11-04 11:48:55,797 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 11:51:19,792 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 11:51:19,793 [trainer.py] => prefix: reproduce
2025-11-04 11:51:19,793 [trainer.py] => dataset: cifar224
2025-11-04 11:51:19,793 [trainer.py] => memory_size: 0
2025-11-04 11:51:19,793 [trainer.py] => memory_per_class: 0
2025-11-04 11:51:19,793 [trainer.py] => fixed_memory: False
2025-11-04 11:51:19,793 [trainer.py] => shuffle: True
2025-11-04 11:51:19,793 [trainer.py] => init_cls: 10
2025-11-04 11:51:19,793 [trainer.py] => increment: 10
2025-11-04 11:51:19,793 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 11:51:19,793 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 11:51:19,793 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-04 11:51:19,793 [trainer.py] => seed: 1993
2025-11-04 11:51:19,793 [trainer.py] => Hidden: 5000
2025-11-04 11:51:19,793 [trainer.py] => rg: 0.1
2025-11-04 11:51:19,793 [trainer.py] => lambda_fkd: 1
2025-11-04 11:51:19,793 [trainer.py] => cali_weight: 1.0
2025-11-04 11:51:19,793 [trainer.py] => alpha: 0.999
2025-11-04 11:51:19,793 [trainer.py] => tuned_epoch: 80
2025-11-04 11:51:19,793 [trainer.py] => progreesive_epoch: 80
2025-11-04 11:51:19,793 [trainer.py] => init_lr: 0.01
2025-11-04 11:51:19,793 [trainer.py] => progressive_lr: 0.01
2025-11-04 11:51:19,793 [trainer.py] => batch_size: 48
2025-11-04 11:51:19,793 [trainer.py] => weight_decay: 0.0005
2025-11-04 11:51:19,793 [trainer.py] => min_lr: 0
2025-11-04 11:51:19,793 [trainer.py] => ffn_num: 64
2025-11-04 11:51:19,793 [trainer.py] => optimizer: sgd
2025-11-04 11:51:19,793 [trainer.py] => vpt_type: shallow
2025-11-04 11:51:19,793 [trainer.py] => prompt_token_num: 5
2025-11-04 11:51:20,997 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 11:51:22,854 [trainer.py] => All params: 86988288
2025-11-04 11:51:22,854 [trainer.py] => Trainable params: 1189632
2025-11-04 11:51:22,854 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 13:43:13,606 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.174, Train_accy 94.80, Test_accy 99.10
2025-11-04 13:44:54,227 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-04 13:45:05,265 [trainer.py] => No NME accuracy.
2025-11-04 13:45:05,266 [trainer.py] => CNN: {'total': 98.9, '00-09': 98.9, 'old': 0, 'new': 98.9}
2025-11-04 13:45:05,266 [trainer.py] => CNN top1 curve: [98.9]
2025-11-04 13:45:05,266 [trainer.py] => CNN top5 curve: [100.0]

2025-11-04 13:45:05,266 [trainer.py] => Average Accuracy (CNN): 98.9 

2025-11-04 13:45:05,266 [trainer.py] => All params: 90885969
2025-11-04 13:45:05,267 [trainer.py] => Trainable params: 5087313
2025-11-04 13:45:05,267 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-04 14:53:25,916 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 14:53:25,916 [trainer.py] => prefix: reproduce
2025-11-04 14:53:25,916 [trainer.py] => dataset: cifar224
2025-11-04 14:53:25,916 [trainer.py] => memory_size: 0
2025-11-04 14:53:25,916 [trainer.py] => memory_per_class: 0
2025-11-04 14:53:25,916 [trainer.py] => fixed_memory: False
2025-11-04 14:53:25,916 [trainer.py] => shuffle: True
2025-11-04 14:53:25,916 [trainer.py] => init_cls: 10
2025-11-04 14:53:25,916 [trainer.py] => increment: 10
2025-11-04 14:53:25,916 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 14:53:25,916 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 14:53:25,917 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 14:53:25,917 [trainer.py] => seed: 1993
2025-11-04 14:53:25,917 [trainer.py] => Hidden: 5000
2025-11-04 14:53:25,917 [trainer.py] => rg: 0.1
2025-11-04 14:53:25,917 [trainer.py] => lambda_fkd: 1
2025-11-04 14:53:25,917 [trainer.py] => cali_weight: 1.0
2025-11-04 14:53:25,917 [trainer.py] => alpha: 0.999
2025-11-04 14:53:25,917 [trainer.py] => tuned_epoch: 80
2025-11-04 14:53:25,917 [trainer.py] => progreesive_epoch: 80
2025-11-04 14:53:25,917 [trainer.py] => init_lr: 0.01
2025-11-04 14:53:25,917 [trainer.py] => progressive_lr: 0.01
2025-11-04 14:53:25,917 [trainer.py] => batch_size: 48
2025-11-04 14:53:25,917 [trainer.py] => weight_decay: 0.0005
2025-11-04 14:53:25,917 [trainer.py] => min_lr: 0
2025-11-04 14:53:25,917 [trainer.py] => ffn_num: 64
2025-11-04 14:53:25,917 [trainer.py] => optimizer: sgd
2025-11-04 14:53:25,917 [trainer.py] => vpt_type: shallow
2025-11-04 14:53:25,917 [trainer.py] => prompt_token_num: 5
2025-11-04 14:53:27,128 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 14:53:29,022 [trainer.py] => All params: 86988288
2025-11-04 14:53:29,023 [trainer.py] => Trainable params: 1189632
2025-11-04 14:53:29,023 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 14:59:54,074 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 14:59:54,074 [trainer.py] => prefix: reproduce
2025-11-04 14:59:54,074 [trainer.py] => dataset: cifar224
2025-11-04 14:59:54,074 [trainer.py] => memory_size: 0
2025-11-04 14:59:54,074 [trainer.py] => memory_per_class: 0
2025-11-04 14:59:54,074 [trainer.py] => fixed_memory: False
2025-11-04 14:59:54,074 [trainer.py] => shuffle: True
2025-11-04 14:59:54,074 [trainer.py] => init_cls: 10
2025-11-04 14:59:54,074 [trainer.py] => increment: 10
2025-11-04 14:59:54,074 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 14:59:54,074 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 14:59:54,074 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 14:59:54,074 [trainer.py] => seed: 1993
2025-11-04 14:59:54,074 [trainer.py] => Hidden: 5000
2025-11-04 14:59:54,075 [trainer.py] => rg: 0.1
2025-11-04 14:59:54,075 [trainer.py] => lambda_fkd: 1
2025-11-04 14:59:54,075 [trainer.py] => cali_weight: 1.0
2025-11-04 14:59:54,075 [trainer.py] => alpha: 0.999
2025-11-04 14:59:54,075 [trainer.py] => tuned_epoch: 80
2025-11-04 14:59:54,075 [trainer.py] => progreesive_epoch: 80
2025-11-04 14:59:54,075 [trainer.py] => init_lr: 0.01
2025-11-04 14:59:54,075 [trainer.py] => progressive_lr: 0.01
2025-11-04 14:59:54,075 [trainer.py] => batch_size: 48
2025-11-04 14:59:54,075 [trainer.py] => weight_decay: 0.0005
2025-11-04 14:59:54,075 [trainer.py] => min_lr: 0
2025-11-04 14:59:54,075 [trainer.py] => ffn_num: 64
2025-11-04 14:59:54,075 [trainer.py] => optimizer: sgd
2025-11-04 14:59:54,075 [trainer.py] => vpt_type: shallow
2025-11-04 14:59:54,075 [trainer.py] => prompt_token_num: 5
2025-11-04 14:59:55,282 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 14:59:57,176 [trainer.py] => All params: 86988288
2025-11-04 14:59:57,176 [trainer.py] => Trainable params: 1189632
2025-11-04 14:59:57,177 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 15:42:06,177 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 15:42:06,178 [trainer.py] => prefix: reproduce
2025-11-04 15:42:06,178 [trainer.py] => dataset: cifar224
2025-11-04 15:42:06,178 [trainer.py] => memory_size: 0
2025-11-04 15:42:06,178 [trainer.py] => memory_per_class: 0
2025-11-04 15:42:06,178 [trainer.py] => fixed_memory: False
2025-11-04 15:42:06,178 [trainer.py] => shuffle: True
2025-11-04 15:42:06,178 [trainer.py] => init_cls: 10
2025-11-04 15:42:06,178 [trainer.py] => increment: 10
2025-11-04 15:42:06,178 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 15:42:06,178 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 15:42:06,178 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 15:42:06,178 [trainer.py] => seed: 1993
2025-11-04 15:42:06,178 [trainer.py] => Hidden: 5000
2025-11-04 15:42:06,178 [trainer.py] => rg: 0.1
2025-11-04 15:42:06,178 [trainer.py] => lambda_fkd: 1
2025-11-04 15:42:06,178 [trainer.py] => cali_weight: 1.0
2025-11-04 15:42:06,178 [trainer.py] => alpha: 0.999
2025-11-04 15:42:06,178 [trainer.py] => tuned_epoch: 80
2025-11-04 15:42:06,178 [trainer.py] => progreesive_epoch: 80
2025-11-04 15:42:06,178 [trainer.py] => init_lr: 0.01
2025-11-04 15:42:06,178 [trainer.py] => progressive_lr: 0.01
2025-11-04 15:42:06,178 [trainer.py] => batch_size: 48
2025-11-04 15:42:06,178 [trainer.py] => weight_decay: 0.0005
2025-11-04 15:42:06,178 [trainer.py] => min_lr: 0
2025-11-04 15:42:06,178 [trainer.py] => ffn_num: 64
2025-11-04 15:42:06,178 [trainer.py] => optimizer: sgd
2025-11-04 15:42:06,178 [trainer.py] => vpt_type: shallow
2025-11-04 15:42:06,178 [trainer.py] => prompt_token_num: 5
2025-11-04 15:42:07,496 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 15:42:09,700 [trainer.py] => All params: 86988288
2025-11-04 15:42:09,701 [trainer.py] => Trainable params: 1189632
2025-11-04 15:42:09,701 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 16:21:55,867 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.174, Train_accy 94.88, Test_accy 99.00
2025-11-04 19:27:47,935 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 19:27:47,935 [trainer.py] => prefix: reproduce
2025-11-04 19:27:47,935 [trainer.py] => dataset: cifar224
2025-11-04 19:27:47,935 [trainer.py] => memory_size: 0
2025-11-04 19:27:47,935 [trainer.py] => memory_per_class: 0
2025-11-04 19:27:47,935 [trainer.py] => fixed_memory: False
2025-11-04 19:27:47,935 [trainer.py] => shuffle: True
2025-11-04 19:27:47,935 [trainer.py] => init_cls: 10
2025-11-04 19:27:47,935 [trainer.py] => increment: 10
2025-11-04 19:27:47,935 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 19:27:47,935 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 19:27:47,935 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 19:27:47,935 [trainer.py] => seed: 1993
2025-11-04 19:27:47,935 [trainer.py] => Hidden: 5000
2025-11-04 19:27:47,935 [trainer.py] => rg: 0.1
2025-11-04 19:27:47,935 [trainer.py] => lambda_fkd: 1
2025-11-04 19:27:47,935 [trainer.py] => cali_weight: 1.0
2025-11-04 19:27:47,935 [trainer.py] => alpha: 0.999
2025-11-04 19:27:47,935 [trainer.py] => tuned_epoch: 80
2025-11-04 19:27:47,935 [trainer.py] => progreesive_epoch: 80
2025-11-04 19:27:47,935 [trainer.py] => init_lr: 0.01
2025-11-04 19:27:47,935 [trainer.py] => progressive_lr: 0.01
2025-11-04 19:27:47,935 [trainer.py] => batch_size: 48
2025-11-04 19:27:47,936 [trainer.py] => weight_decay: 0.0005
2025-11-04 19:27:47,936 [trainer.py] => min_lr: 0
2025-11-04 19:27:47,936 [trainer.py] => ffn_num: 64
2025-11-04 19:27:47,936 [trainer.py] => optimizer: sgd
2025-11-04 19:27:47,936 [trainer.py] => vpt_type: shallow
2025-11-04 19:27:47,936 [trainer.py] => prompt_token_num: 5
2025-11-04 19:27:49,148 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 19:27:51,018 [trainer.py] => All params: 86988288
2025-11-04 19:27:51,018 [trainer.py] => Trainable params: 1189632
2025-11-04 19:27:51,019 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 19:28:45,317 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 19:28:45,317 [trainer.py] => prefix: reproduce
2025-11-04 19:28:45,317 [trainer.py] => dataset: cifar224
2025-11-04 19:28:45,318 [trainer.py] => memory_size: 0
2025-11-04 19:28:45,318 [trainer.py] => memory_per_class: 0
2025-11-04 19:28:45,318 [trainer.py] => fixed_memory: False
2025-11-04 19:28:45,318 [trainer.py] => shuffle: True
2025-11-04 19:28:45,318 [trainer.py] => init_cls: 10
2025-11-04 19:28:45,318 [trainer.py] => increment: 10
2025-11-04 19:28:45,318 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 19:28:45,318 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 19:28:45,318 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 19:28:45,318 [trainer.py] => seed: 1993
2025-11-04 19:28:45,318 [trainer.py] => Hidden: 5000
2025-11-04 19:28:45,318 [trainer.py] => rg: 0.1
2025-11-04 19:28:45,318 [trainer.py] => lambda_fkd: 1
2025-11-04 19:28:45,318 [trainer.py] => cali_weight: 1.0
2025-11-04 19:28:45,318 [trainer.py] => alpha: 0.999
2025-11-04 19:28:45,318 [trainer.py] => tuned_epoch: 1
2025-11-04 19:28:45,318 [trainer.py] => progreesive_epoch: 1
2025-11-04 19:28:45,318 [trainer.py] => init_lr: 0.01
2025-11-04 19:28:45,318 [trainer.py] => progressive_lr: 0.01
2025-11-04 19:28:45,318 [trainer.py] => batch_size: 48
2025-11-04 19:28:45,318 [trainer.py] => weight_decay: 0.0005
2025-11-04 19:28:45,318 [trainer.py] => min_lr: 0
2025-11-04 19:28:45,318 [trainer.py] => ffn_num: 64
2025-11-04 19:28:45,318 [trainer.py] => optimizer: sgd
2025-11-04 19:28:45,318 [trainer.py] => vpt_type: shallow
2025-11-04 19:28:45,318 [trainer.py] => prompt_token_num: 5
2025-11-04 19:28:46,541 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 19:28:48,401 [trainer.py] => All params: 86988288
2025-11-04 19:28:48,401 [trainer.py] => Trainable params: 1189632
2025-11-04 19:28:48,402 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 19:29:23,235 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 1/1 => Loss 2.119, Train_accy 58.56, Test_accy 87.90
2025-11-04 19:33:41,353 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 19:33:41,353 [trainer.py] => prefix: reproduce
2025-11-04 19:33:41,353 [trainer.py] => dataset: cifar224
2025-11-04 19:33:41,353 [trainer.py] => memory_size: 0
2025-11-04 19:33:41,354 [trainer.py] => memory_per_class: 0
2025-11-04 19:33:41,354 [trainer.py] => fixed_memory: False
2025-11-04 19:33:41,354 [trainer.py] => shuffle: True
2025-11-04 19:33:41,354 [trainer.py] => init_cls: 10
2025-11-04 19:33:41,354 [trainer.py] => increment: 10
2025-11-04 19:33:41,354 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 19:33:41,354 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 19:33:41,354 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 19:33:41,354 [trainer.py] => seed: 1993
2025-11-04 19:33:41,354 [trainer.py] => Hidden: 5000
2025-11-04 19:33:41,354 [trainer.py] => rg: 0.1
2025-11-04 19:33:41,354 [trainer.py] => lambda_fkd: 1
2025-11-04 19:33:41,354 [trainer.py] => cali_weight: 1.0
2025-11-04 19:33:41,354 [trainer.py] => alpha: 0.999
2025-11-04 19:33:41,354 [trainer.py] => tuned_epoch: 1
2025-11-04 19:33:41,354 [trainer.py] => progreesive_epoch: 1
2025-11-04 19:33:41,354 [trainer.py] => init_lr: 0.01
2025-11-04 19:33:41,354 [trainer.py] => progressive_lr: 0.01
2025-11-04 19:33:41,354 [trainer.py] => batch_size: 48
2025-11-04 19:33:41,354 [trainer.py] => weight_decay: 0.0005
2025-11-04 19:33:41,354 [trainer.py] => min_lr: 0
2025-11-04 19:33:41,354 [trainer.py] => ffn_num: 64
2025-11-04 19:33:41,354 [trainer.py] => optimizer: sgd
2025-11-04 19:33:41,354 [trainer.py] => vpt_type: shallow
2025-11-04 19:33:41,354 [trainer.py] => prompt_token_num: 5
2025-11-04 19:33:42,565 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 19:33:44,428 [trainer.py] => All params: 86988288
2025-11-04 19:33:44,429 [trainer.py] => Trainable params: 1189632
2025-11-04 19:33:44,429 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 19:34:19,302 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 1/1 => Loss 2.119, Train_accy 58.56, Test_accy 87.90
2025-11-04 19:36:00,143 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-04 19:41:13,531 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 19:41:13,531 [trainer.py] => prefix: reproduce
2025-11-04 19:41:13,531 [trainer.py] => dataset: cifar224
2025-11-04 19:41:13,531 [trainer.py] => memory_size: 0
2025-11-04 19:41:13,531 [trainer.py] => memory_per_class: 0
2025-11-04 19:41:13,531 [trainer.py] => fixed_memory: False
2025-11-04 19:41:13,531 [trainer.py] => shuffle: True
2025-11-04 19:41:13,531 [trainer.py] => init_cls: 10
2025-11-04 19:41:13,531 [trainer.py] => increment: 10
2025-11-04 19:41:13,531 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 19:41:13,531 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 19:41:13,531 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 19:41:13,531 [trainer.py] => seed: 1993
2025-11-04 19:41:13,531 [trainer.py] => Hidden: 5000
2025-11-04 19:41:13,531 [trainer.py] => rg: 0.1
2025-11-04 19:41:13,531 [trainer.py] => lambda_fkd: 1
2025-11-04 19:41:13,531 [trainer.py] => cali_weight: 1.0
2025-11-04 19:41:13,531 [trainer.py] => alpha: 0.999
2025-11-04 19:41:13,532 [trainer.py] => tuned_epoch: 1
2025-11-04 19:41:13,532 [trainer.py] => progreesive_epoch: 1
2025-11-04 19:41:13,532 [trainer.py] => init_lr: 0.01
2025-11-04 19:41:13,532 [trainer.py] => progressive_lr: 0.01
2025-11-04 19:41:13,532 [trainer.py] => batch_size: 48
2025-11-04 19:41:13,532 [trainer.py] => weight_decay: 0.0005
2025-11-04 19:41:13,532 [trainer.py] => min_lr: 0
2025-11-04 19:41:13,532 [trainer.py] => ffn_num: 64
2025-11-04 19:41:13,532 [trainer.py] => optimizer: sgd
2025-11-04 19:41:13,532 [trainer.py] => vpt_type: shallow
2025-11-04 19:41:13,532 [trainer.py] => prompt_token_num: 5
2025-11-04 19:41:14,743 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 19:41:16,599 [trainer.py] => All params: 86988288
2025-11-04 19:41:16,600 [trainer.py] => Trainable params: 1189632
2025-11-04 19:41:16,600 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 19:41:51,474 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 1/1 => Loss 2.119, Train_accy 58.56, Test_accy 87.90
2025-11-04 19:43:32,411 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-04 19:43:43,650 [trainer.py] => No NME accuracy.
2025-11-04 19:43:43,651 [trainer.py] => CNN: {'total': 97.5, '00-09': 97.5, 'old': 0, 'new': 97.5}
2025-11-04 19:43:43,651 [trainer.py] => CNN top1 curve: [97.5]
2025-11-04 19:43:43,651 [trainer.py] => CNN top5 curve: [99.9]

2025-11-04 19:43:43,651 [trainer.py] => Average Accuracy (CNN): 97.5 

2025-11-04 19:43:43,653 [trainer.py] => All params: 90885969
2025-11-04 19:43:43,654 [trainer.py] => Trainable params: 5087313
2025-11-04 19:43:43,654 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-04 19:47:28,572 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 19:47:28,572 [trainer.py] => prefix: reproduce
2025-11-04 19:47:28,572 [trainer.py] => dataset: cifar224
2025-11-04 19:47:28,572 [trainer.py] => memory_size: 0
2025-11-04 19:47:28,572 [trainer.py] => memory_per_class: 0
2025-11-04 19:47:28,572 [trainer.py] => fixed_memory: False
2025-11-04 19:47:28,572 [trainer.py] => shuffle: True
2025-11-04 19:47:28,573 [trainer.py] => init_cls: 10
2025-11-04 19:47:28,573 [trainer.py] => increment: 10
2025-11-04 19:47:28,573 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 19:47:28,573 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 19:47:28,573 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 19:47:28,573 [trainer.py] => seed: 1993
2025-11-04 19:47:28,573 [trainer.py] => Hidden: 5000
2025-11-04 19:47:28,573 [trainer.py] => rg: 0.1
2025-11-04 19:47:28,573 [trainer.py] => lambda_fkd: 1
2025-11-04 19:47:28,573 [trainer.py] => cali_weight: 1.0
2025-11-04 19:47:28,573 [trainer.py] => alpha: 0.999
2025-11-04 19:47:28,573 [trainer.py] => tuned_epoch: 1
2025-11-04 19:47:28,573 [trainer.py] => progreesive_epoch: 1
2025-11-04 19:47:28,573 [trainer.py] => init_lr: 0.01
2025-11-04 19:47:28,573 [trainer.py] => progressive_lr: 0.01
2025-11-04 19:47:28,573 [trainer.py] => batch_size: 48
2025-11-04 19:47:28,573 [trainer.py] => weight_decay: 0.0005
2025-11-04 19:47:28,573 [trainer.py] => min_lr: 0
2025-11-04 19:47:28,573 [trainer.py] => ffn_num: 64
2025-11-04 19:47:28,573 [trainer.py] => optimizer: sgd
2025-11-04 19:47:28,573 [trainer.py] => vpt_type: shallow
2025-11-04 19:47:28,573 [trainer.py] => prompt_token_num: 5
2025-11-04 19:47:29,779 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 19:47:31,634 [trainer.py] => All params: 86988288
2025-11-04 19:47:31,635 [trainer.py] => Trainable params: 1189632
2025-11-04 19:47:31,635 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 19:48:06,571 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 1/1 => Loss 2.119, Train_accy 58.56, Test_accy 87.90
2025-11-04 19:49:47,355 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-04 19:49:58,553 [trainer.py] => No NME accuracy.
2025-11-04 19:49:58,554 [trainer.py] => CNN: {'total': 97.5, '00-09': 97.5, 'old': 0, 'new': 97.5}
2025-11-04 19:49:58,554 [trainer.py] => CNN top1 curve: [97.5]
2025-11-04 19:49:58,554 [trainer.py] => CNN top5 curve: [99.9]

2025-11-04 19:49:58,554 [trainer.py] => Average Accuracy (CNN): 97.5 

2025-11-04 19:49:58,555 [trainer.py] => All params: 90885969
2025-11-04 19:49:58,555 [trainer.py] => Trainable params: 5087313
2025-11-04 19:49:58,555 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-04 19:51:43,929 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 19:51:43,929 [trainer.py] => prefix: reproduce
2025-11-04 19:51:43,929 [trainer.py] => dataset: cifar224
2025-11-04 19:51:43,929 [trainer.py] => memory_size: 0
2025-11-04 19:51:43,929 [trainer.py] => memory_per_class: 0
2025-11-04 19:51:43,929 [trainer.py] => fixed_memory: False
2025-11-04 19:51:43,929 [trainer.py] => shuffle: True
2025-11-04 19:51:43,929 [trainer.py] => init_cls: 10
2025-11-04 19:51:43,929 [trainer.py] => increment: 10
2025-11-04 19:51:43,929 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 19:51:43,929 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 19:51:43,929 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 19:51:43,929 [trainer.py] => seed: 1993
2025-11-04 19:51:43,929 [trainer.py] => Hidden: 5000
2025-11-04 19:51:43,929 [trainer.py] => rg: 0.1
2025-11-04 19:51:43,930 [trainer.py] => lambda_fkd: 1
2025-11-04 19:51:43,930 [trainer.py] => cali_weight: 1.0
2025-11-04 19:51:43,930 [trainer.py] => alpha: 0.999
2025-11-04 19:51:43,930 [trainer.py] => tuned_epoch: 1
2025-11-04 19:51:43,930 [trainer.py] => progreesive_epoch: 1
2025-11-04 19:51:43,930 [trainer.py] => init_lr: 0.01
2025-11-04 19:51:43,930 [trainer.py] => progressive_lr: 0.01
2025-11-04 19:51:43,930 [trainer.py] => batch_size: 48
2025-11-04 19:51:43,930 [trainer.py] => weight_decay: 0.0005
2025-11-04 19:51:43,930 [trainer.py] => min_lr: 0
2025-11-04 19:51:43,930 [trainer.py] => ffn_num: 64
2025-11-04 19:51:43,930 [trainer.py] => optimizer: sgd
2025-11-04 19:51:43,930 [trainer.py] => vpt_type: shallow
2025-11-04 19:51:43,930 [trainer.py] => prompt_token_num: 5
2025-11-04 19:51:45,142 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 19:51:46,997 [trainer.py] => All params: 86988288
2025-11-04 19:51:46,997 [trainer.py] => Trainable params: 1189632
2025-11-04 19:51:46,997 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 19:52:22,055 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 1/1 => Loss 2.119, Train_accy 58.56, Test_accy 87.90
2025-11-04 19:54:03,259 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-04 19:54:14,420 [trainer.py] => No NME accuracy.
2025-11-04 19:54:14,421 [trainer.py] => CNN: {'total': 97.5, '00-09': 97.5, 'old': 0, 'new': 97.5}
2025-11-04 19:54:14,421 [trainer.py] => CNN top1 curve: [97.5]
2025-11-04 19:54:14,421 [trainer.py] => CNN top5 curve: [99.9]

2025-11-04 19:54:14,421 [trainer.py] => Average Accuracy (CNN): 97.5 

2025-11-04 19:54:14,422 [trainer.py] => All params: 90885969
2025-11-04 19:54:14,423 [trainer.py] => Trainable params: 5087313
2025-11-04 19:54:14,423 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-04 19:59:10,738 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 19:59:10,738 [trainer.py] => prefix: reproduce
2025-11-04 19:59:10,738 [trainer.py] => dataset: cifar224
2025-11-04 19:59:10,738 [trainer.py] => memory_size: 0
2025-11-04 19:59:10,738 [trainer.py] => memory_per_class: 0
2025-11-04 19:59:10,738 [trainer.py] => fixed_memory: False
2025-11-04 19:59:10,738 [trainer.py] => shuffle: True
2025-11-04 19:59:10,738 [trainer.py] => init_cls: 10
2025-11-04 19:59:10,738 [trainer.py] => increment: 10
2025-11-04 19:59:10,738 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 19:59:10,738 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 19:59:10,738 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 19:59:10,738 [trainer.py] => seed: 1993
2025-11-04 19:59:10,738 [trainer.py] => Hidden: 5000
2025-11-04 19:59:10,738 [trainer.py] => rg: 0.1
2025-11-04 19:59:10,738 [trainer.py] => lambda_fkd: 1
2025-11-04 19:59:10,738 [trainer.py] => cali_weight: 1.0
2025-11-04 19:59:10,738 [trainer.py] => alpha: 0.999
2025-11-04 19:59:10,738 [trainer.py] => tuned_epoch: 1
2025-11-04 19:59:10,738 [trainer.py] => progreesive_epoch: 1
2025-11-04 19:59:10,738 [trainer.py] => init_lr: 0.01
2025-11-04 19:59:10,738 [trainer.py] => progressive_lr: 0.01
2025-11-04 19:59:10,738 [trainer.py] => batch_size: 48
2025-11-04 19:59:10,738 [trainer.py] => weight_decay: 0.0005
2025-11-04 19:59:10,738 [trainer.py] => min_lr: 0
2025-11-04 19:59:10,738 [trainer.py] => ffn_num: 64
2025-11-04 19:59:10,738 [trainer.py] => optimizer: sgd
2025-11-04 19:59:10,739 [trainer.py] => vpt_type: shallow
2025-11-04 19:59:10,739 [trainer.py] => prompt_token_num: 5
2025-11-04 19:59:11,950 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 19:59:13,808 [trainer.py] => All params: 86988288
2025-11-04 19:59:13,808 [trainer.py] => Trainable params: 1189632
2025-11-04 19:59:13,809 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 19:59:48,795 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 1/1 => Loss 2.119, Train_accy 58.56, Test_accy 87.90
2025-11-04 20:01:29,800 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-04 20:01:40,993 [trainer.py] => No NME accuracy.
2025-11-04 20:01:40,993 [trainer.py] => CNN: {'total': 97.5, '00-09': 97.5, 'old': 0, 'new': 97.5}
2025-11-04 20:01:40,993 [trainer.py] => CNN top1 curve: [97.5]
2025-11-04 20:01:40,993 [trainer.py] => CNN top5 curve: [99.9]

2025-11-04 20:01:40,993 [trainer.py] => Average Accuracy (CNN): 97.5 

2025-11-04 20:01:40,994 [trainer.py] => All params: 90885969
2025-11-04 20:01:40,994 [trainer.py] => Trainable params: 5087313
2025-11-04 20:01:40,994 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-04 20:13:50,179 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 20:13:50,179 [trainer.py] => prefix: reproduce
2025-11-04 20:13:50,179 [trainer.py] => dataset: cifar224
2025-11-04 20:13:50,179 [trainer.py] => memory_size: 0
2025-11-04 20:13:50,179 [trainer.py] => memory_per_class: 0
2025-11-04 20:13:50,180 [trainer.py] => fixed_memory: False
2025-11-04 20:13:50,180 [trainer.py] => shuffle: True
2025-11-04 20:13:50,180 [trainer.py] => init_cls: 10
2025-11-04 20:13:50,180 [trainer.py] => increment: 10
2025-11-04 20:13:50,180 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 20:13:50,180 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 20:13:50,180 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 20:13:50,180 [trainer.py] => seed: 1993
2025-11-04 20:13:50,180 [trainer.py] => Hidden: 5000
2025-11-04 20:13:50,180 [trainer.py] => rg: 0.1
2025-11-04 20:13:50,180 [trainer.py] => lambda_fkd: 1
2025-11-04 20:13:50,180 [trainer.py] => cali_weight: 1.0
2025-11-04 20:13:50,180 [trainer.py] => alpha: 0.999
2025-11-04 20:13:50,180 [trainer.py] => tuned_epoch: 1
2025-11-04 20:13:50,180 [trainer.py] => progreesive_epoch: 1
2025-11-04 20:13:50,180 [trainer.py] => init_lr: 0.01
2025-11-04 20:13:50,180 [trainer.py] => progressive_lr: 0.01
2025-11-04 20:13:50,180 [trainer.py] => batch_size: 48
2025-11-04 20:13:50,180 [trainer.py] => weight_decay: 0.0005
2025-11-04 20:13:50,180 [trainer.py] => min_lr: 0
2025-11-04 20:13:50,180 [trainer.py] => ffn_num: 64
2025-11-04 20:13:50,180 [trainer.py] => optimizer: sgd
2025-11-04 20:13:50,180 [trainer.py] => vpt_type: shallow
2025-11-04 20:13:50,180 [trainer.py] => prompt_token_num: 5
2025-11-04 20:13:51,395 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 20:13:53,256 [trainer.py] => All params: 86988288
2025-11-04 20:13:53,257 [trainer.py] => Trainable params: 1189632
2025-11-04 20:13:53,257 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 20:15:16,957 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 1/1 => Loss 2.119, Train_accy 58.56, Test_accy 87.90
2025-11-04 20:16:56,880 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-04 20:17:07,986 [trainer.py] => No NME accuracy.
2025-11-04 20:17:07,987 [trainer.py] => CNN: {'total': 97.5, '00-09': 97.5, 'old': 0, 'new': 97.5}
2025-11-04 20:17:07,987 [trainer.py] => CNN top1 curve: [97.5]
2025-11-04 20:17:07,987 [trainer.py] => CNN top5 curve: [99.9]

2025-11-04 20:17:07,987 [trainer.py] => Average Accuracy (CNN): 97.5 

2025-11-04 20:17:07,987 [trainer.py] => All params: 90885969
2025-11-04 20:17:07,988 [trainer.py] => Trainable params: 5087313
2025-11-04 20:17:07,988 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-04 20:18:41,276 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 1/1 => Loss 2.214, Train_accy 50.80, Test_accy 34.80
2025-11-04 20:21:06,576 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-04 20:23:04,520 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.030473141953349114
2025-11-04 20:25:11,288 [trainer.py] => No NME accuracy.
2025-11-04 20:25:11,288 [trainer.py] => CNN: {'total': 94.15, '00-09': 93.8, '10-19': 94.5, 'old': 93.8, 'new': 94.5}
2025-11-04 20:25:11,288 [trainer.py] => CNN top1 curve: [97.5, 94.15]
2025-11-04 20:25:11,288 [trainer.py] => CNN top5 curve: [99.9, 98.55]

2025-11-04 20:25:11,289 [trainer.py] => Average Accuracy (CNN): 95.825 

2025-11-04 20:25:11,289 [trainer.py] => All params: 90943649
2025-11-04 20:25:11,290 [trainer.py] => Trainable params: 1304993
2025-11-04 20:25:11,290 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 20-30
2025-11-04 20:26:53,950 [adapt_ac_com_sdc_EMA_auto.py] => Task 2, Epoch 1/1 => Loss 2.122, Train_accy 67.26, Test_accy 50.87
2025-11-04 20:29:19,262 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-04 20:31:19,969 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.03056739553809166
2025-11-04 20:35:19,734 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 20:35:19,734 [trainer.py] => prefix: reproduce
2025-11-04 20:35:19,734 [trainer.py] => dataset: cifar224
2025-11-04 20:35:19,734 [trainer.py] => memory_size: 0
2025-11-04 20:35:19,734 [trainer.py] => memory_per_class: 0
2025-11-04 20:35:19,734 [trainer.py] => fixed_memory: False
2025-11-04 20:35:19,734 [trainer.py] => shuffle: True
2025-11-04 20:35:19,734 [trainer.py] => init_cls: 10
2025-11-04 20:35:19,734 [trainer.py] => increment: 10
2025-11-04 20:35:19,734 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 20:35:19,734 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 20:35:19,734 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 20:35:19,734 [trainer.py] => seed: 1993
2025-11-04 20:35:19,734 [trainer.py] => Hidden: 5000
2025-11-04 20:35:19,734 [trainer.py] => rg: 0.1
2025-11-04 20:35:19,734 [trainer.py] => lambda_fkd: 1
2025-11-04 20:35:19,734 [trainer.py] => cali_weight: 1.0
2025-11-04 20:35:19,734 [trainer.py] => alpha: 0.999
2025-11-04 20:35:19,734 [trainer.py] => tuned_epoch: 80
2025-11-04 20:35:19,734 [trainer.py] => progreesive_epoch: 80
2025-11-04 20:35:19,734 [trainer.py] => init_lr: 0.01
2025-11-04 20:35:19,734 [trainer.py] => progressive_lr: 0.01
2025-11-04 20:35:19,734 [trainer.py] => batch_size: 48
2025-11-04 20:35:19,734 [trainer.py] => weight_decay: 0.0005
2025-11-04 20:35:19,734 [trainer.py] => min_lr: 0
2025-11-04 20:35:19,734 [trainer.py] => ffn_num: 64
2025-11-04 20:35:19,734 [trainer.py] => optimizer: sgd
2025-11-04 20:35:19,734 [trainer.py] => vpt_type: shallow
2025-11-04 20:35:19,735 [trainer.py] => prompt_token_num: 5
2025-11-04 20:35:20,954 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 20:35:22,817 [trainer.py] => All params: 86988288
2025-11-04 20:35:22,818 [trainer.py] => Trainable params: 1189632
2025-11-04 20:35:22,818 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 20:54:03,288 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 20:54:03,288 [trainer.py] => prefix: reproduce
2025-11-04 20:54:03,288 [trainer.py] => dataset: cifar224
2025-11-04 20:54:03,288 [trainer.py] => memory_size: 0
2025-11-04 20:54:03,288 [trainer.py] => memory_per_class: 0
2025-11-04 20:54:03,288 [trainer.py] => fixed_memory: False
2025-11-04 20:54:03,288 [trainer.py] => shuffle: True
2025-11-04 20:54:03,288 [trainer.py] => init_cls: 10
2025-11-04 20:54:03,288 [trainer.py] => increment: 10
2025-11-04 20:54:03,288 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 20:54:03,288 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 20:54:03,288 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 20:54:03,288 [trainer.py] => seed: 1993
2025-11-04 20:54:03,288 [trainer.py] => Hidden: 5000
2025-11-04 20:54:03,288 [trainer.py] => rg: 0.1
2025-11-04 20:54:03,288 [trainer.py] => lambda_fkd: 1
2025-11-04 20:54:03,288 [trainer.py] => cali_weight: 1.0
2025-11-04 20:54:03,288 [trainer.py] => alpha: 0.999
2025-11-04 20:54:03,288 [trainer.py] => tuned_epoch: 80
2025-11-04 20:54:03,288 [trainer.py] => progreesive_epoch: 80
2025-11-04 20:54:03,288 [trainer.py] => init_lr: 0.01
2025-11-04 20:54:03,288 [trainer.py] => progressive_lr: 0.01
2025-11-04 20:54:03,288 [trainer.py] => batch_size: 48
2025-11-04 20:54:03,288 [trainer.py] => weight_decay: 0.0005
2025-11-04 20:54:03,288 [trainer.py] => min_lr: 0
2025-11-04 20:54:03,288 [trainer.py] => ffn_num: 64
2025-11-04 20:54:03,288 [trainer.py] => optimizer: sgd
2025-11-04 20:54:03,288 [trainer.py] => vpt_type: shallow
2025-11-04 20:54:03,288 [trainer.py] => prompt_token_num: 5
2025-11-04 20:54:04,514 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 20:54:06,380 [trainer.py] => All params: 86988288
2025-11-04 20:54:06,380 [trainer.py] => Trainable params: 1189632
2025-11-04 20:54:06,381 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 20:54:35,566 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 20:54:35,566 [trainer.py] => prefix: reproduce
2025-11-04 20:54:35,566 [trainer.py] => dataset: cifar224
2025-11-04 20:54:35,566 [trainer.py] => memory_size: 0
2025-11-04 20:54:35,566 [trainer.py] => memory_per_class: 0
2025-11-04 20:54:35,566 [trainer.py] => fixed_memory: False
2025-11-04 20:54:35,566 [trainer.py] => shuffle: True
2025-11-04 20:54:35,566 [trainer.py] => init_cls: 10
2025-11-04 20:54:35,566 [trainer.py] => increment: 10
2025-11-04 20:54:35,566 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 20:54:35,566 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 20:54:35,566 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 20:54:35,566 [trainer.py] => seed: 1993
2025-11-04 20:54:35,566 [trainer.py] => Hidden: 5000
2025-11-04 20:54:35,566 [trainer.py] => rg: 0.1
2025-11-04 20:54:35,566 [trainer.py] => lambda_fkd: 1
2025-11-04 20:54:35,566 [trainer.py] => cali_weight: 1.0
2025-11-04 20:54:35,566 [trainer.py] => alpha: 0.999
2025-11-04 20:54:35,566 [trainer.py] => tuned_epoch: 1
2025-11-04 20:54:35,566 [trainer.py] => progreesive_epoch: 1
2025-11-04 20:54:35,566 [trainer.py] => init_lr: 0.01
2025-11-04 20:54:35,567 [trainer.py] => progressive_lr: 0.01
2025-11-04 20:54:35,567 [trainer.py] => batch_size: 48
2025-11-04 20:54:35,567 [trainer.py] => weight_decay: 0.0005
2025-11-04 20:54:35,567 [trainer.py] => min_lr: 0
2025-11-04 20:54:35,567 [trainer.py] => ffn_num: 64
2025-11-04 20:54:35,567 [trainer.py] => optimizer: sgd
2025-11-04 20:54:35,567 [trainer.py] => vpt_type: shallow
2025-11-04 20:54:35,567 [trainer.py] => prompt_token_num: 5
2025-11-04 20:54:36,790 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 20:54:38,664 [trainer.py] => All params: 86988288
2025-11-04 20:54:38,664 [trainer.py] => Trainable params: 1189632
2025-11-04 20:54:38,665 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 20:56:03,672 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 1/1 => Loss 2.119, Train_accy 58.56, Test_accy 87.90
2025-11-04 20:57:44,645 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-04 20:57:55,989 [trainer.py] => No NME accuracy.
2025-11-04 20:57:55,990 [trainer.py] => CNN: {'total': 97.5, '00-09': 97.5, 'old': 0, 'new': 97.5}
2025-11-04 20:57:55,990 [trainer.py] => CNN top1 curve: [97.5]
2025-11-04 20:57:55,990 [trainer.py] => CNN top5 curve: [99.9]

2025-11-04 20:57:55,990 [trainer.py] => Average Accuracy (CNN): 97.5 

2025-11-04 20:57:55,990 [trainer.py] => All params: 90885969
2025-11-04 20:57:55,991 [trainer.py] => Trainable params: 5087313
2025-11-04 20:57:55,991 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-04 20:58:20,440 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 20:58:20,440 [trainer.py] => prefix: reproduce
2025-11-04 20:58:20,440 [trainer.py] => dataset: cifar224
2025-11-04 20:58:20,440 [trainer.py] => memory_size: 0
2025-11-04 20:58:20,440 [trainer.py] => memory_per_class: 0
2025-11-04 20:58:20,440 [trainer.py] => fixed_memory: False
2025-11-04 20:58:20,440 [trainer.py] => shuffle: True
2025-11-04 20:58:20,440 [trainer.py] => init_cls: 10
2025-11-04 20:58:20,440 [trainer.py] => increment: 10
2025-11-04 20:58:20,440 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 20:58:20,440 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 20:58:20,440 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 20:58:20,440 [trainer.py] => seed: 1993
2025-11-04 20:58:20,440 [trainer.py] => Hidden: 5000
2025-11-04 20:58:20,440 [trainer.py] => rg: 0.1
2025-11-04 20:58:20,440 [trainer.py] => lambda_fkd: 1
2025-11-04 20:58:20,440 [trainer.py] => cali_weight: 1.0
2025-11-04 20:58:20,440 [trainer.py] => alpha: 0.999
2025-11-04 20:58:20,440 [trainer.py] => tuned_epoch: 1
2025-11-04 20:58:20,440 [trainer.py] => progreesive_epoch: 1
2025-11-04 20:58:20,441 [trainer.py] => init_lr: 0.01
2025-11-04 20:58:20,441 [trainer.py] => progressive_lr: 0.01
2025-11-04 20:58:20,441 [trainer.py] => batch_size: 48
2025-11-04 20:58:20,441 [trainer.py] => weight_decay: 0.0005
2025-11-04 20:58:20,441 [trainer.py] => min_lr: 0
2025-11-04 20:58:20,441 [trainer.py] => ffn_num: 64
2025-11-04 20:58:20,441 [trainer.py] => optimizer: sgd
2025-11-04 20:58:20,441 [trainer.py] => vpt_type: shallow
2025-11-04 20:58:20,441 [trainer.py] => prompt_token_num: 5
2025-11-04 20:58:21,665 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 20:58:23,534 [trainer.py] => All params: 86988288
2025-11-04 20:58:23,534 [trainer.py] => Trainable params: 1189632
2025-11-04 20:58:23,534 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 20:58:58,666 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 1/1 => Loss 2.119, Train_accy 58.56, Test_accy 87.90
2025-11-04 21:00:40,934 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-04 21:00:52,256 [trainer.py] => No NME accuracy.
2025-11-04 21:00:52,256 [trainer.py] => CNN: {'total': 97.5, '00-09': 97.5, 'old': 0, 'new': 97.5}
2025-11-04 21:00:52,257 [trainer.py] => CNN top1 curve: [97.5]
2025-11-04 21:00:52,257 [trainer.py] => CNN top5 curve: [99.9]

2025-11-04 21:00:52,257 [trainer.py] => Average Accuracy (CNN): 97.5 

2025-11-04 21:00:52,257 [trainer.py] => All params: 90885969
2025-11-04 21:00:52,258 [trainer.py] => Trainable params: 5087313
2025-11-04 21:00:52,258 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-04 21:04:31,598 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 21:04:31,599 [trainer.py] => prefix: reproduce
2025-11-04 21:04:31,599 [trainer.py] => dataset: cifar224
2025-11-04 21:04:31,599 [trainer.py] => memory_size: 0
2025-11-04 21:04:31,599 [trainer.py] => memory_per_class: 0
2025-11-04 21:04:31,599 [trainer.py] => fixed_memory: False
2025-11-04 21:04:31,599 [trainer.py] => shuffle: True
2025-11-04 21:04:31,599 [trainer.py] => init_cls: 10
2025-11-04 21:04:31,599 [trainer.py] => increment: 10
2025-11-04 21:04:31,599 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 21:04:31,599 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 21:04:31,599 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 21:04:31,599 [trainer.py] => seed: 1993
2025-11-04 21:04:31,599 [trainer.py] => Hidden: 5000
2025-11-04 21:04:31,599 [trainer.py] => rg: 0.1
2025-11-04 21:04:31,599 [trainer.py] => lambda_fkd: 1
2025-11-04 21:04:31,599 [trainer.py] => cali_weight: 1.0
2025-11-04 21:04:31,599 [trainer.py] => alpha: 0.999
2025-11-04 21:04:31,599 [trainer.py] => tuned_epoch: 1
2025-11-04 21:04:31,599 [trainer.py] => progreesive_epoch: 1
2025-11-04 21:04:31,599 [trainer.py] => init_lr: 0.01
2025-11-04 21:04:31,599 [trainer.py] => progressive_lr: 0.01
2025-11-04 21:04:31,599 [trainer.py] => batch_size: 48
2025-11-04 21:04:31,599 [trainer.py] => weight_decay: 0.0005
2025-11-04 21:04:31,599 [trainer.py] => min_lr: 0
2025-11-04 21:04:31,599 [trainer.py] => ffn_num: 64
2025-11-04 21:04:31,599 [trainer.py] => optimizer: sgd
2025-11-04 21:04:31,599 [trainer.py] => vpt_type: shallow
2025-11-04 21:04:31,599 [trainer.py] => prompt_token_num: 5
2025-11-04 21:04:32,822 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 21:04:34,725 [trainer.py] => All params: 86988288
2025-11-04 21:04:34,726 [trainer.py] => Trainable params: 1189632
2025-11-04 21:04:34,727 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 21:05:58,930 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 1/1 => Loss 2.119, Train_accy 58.56, Test_accy 87.90
2025-11-04 21:07:39,352 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-04 21:07:50,559 [trainer.py] => No NME accuracy.
2025-11-04 21:07:50,559 [trainer.py] => CNN: {'total': 97.5, '00-09': 97.5, 'old': 0, 'new': 97.5}
2025-11-04 21:07:50,559 [trainer.py] => CNN top1 curve: [97.5]
2025-11-04 21:07:50,559 [trainer.py] => CNN top5 curve: [99.9]

2025-11-04 21:07:50,559 [trainer.py] => Average Accuracy (CNN): 97.5 

2025-11-04 21:07:50,560 [trainer.py] => All params: 90885969
2025-11-04 21:07:50,560 [trainer.py] => Trainable params: 5087313
2025-11-04 21:07:50,560 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-04 21:09:24,295 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 1/1 => Loss 2.214, Train_accy 50.80, Test_accy 34.80
2025-11-04 21:11:49,758 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-04 21:13:58,736 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.030473141953349114
2025-11-04 21:16:05,954 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-04 21:16:05,954 [trainer.py] => prefix: reproduce
2025-11-04 21:16:05,954 [trainer.py] => dataset: cifar224
2025-11-04 21:16:05,954 [trainer.py] => memory_size: 0
2025-11-04 21:16:05,954 [trainer.py] => memory_per_class: 0
2025-11-04 21:16:05,955 [trainer.py] => fixed_memory: False
2025-11-04 21:16:05,955 [trainer.py] => shuffle: True
2025-11-04 21:16:05,955 [trainer.py] => init_cls: 10
2025-11-04 21:16:05,955 [trainer.py] => increment: 10
2025-11-04 21:16:05,955 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-04 21:16:05,955 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-04 21:16:05,955 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2025-11-04 21:16:05,955 [trainer.py] => seed: 1993
2025-11-04 21:16:05,955 [trainer.py] => Hidden: 5000
2025-11-04 21:16:05,955 [trainer.py] => rg: 0.1
2025-11-04 21:16:05,955 [trainer.py] => lambda_fkd: 1
2025-11-04 21:16:05,955 [trainer.py] => cali_weight: 1.0
2025-11-04 21:16:05,955 [trainer.py] => alpha: 0.999
2025-11-04 21:16:05,955 [trainer.py] => tuned_epoch: 80
2025-11-04 21:16:05,955 [trainer.py] => progreesive_epoch: 80
2025-11-04 21:16:05,955 [trainer.py] => init_lr: 0.01
2025-11-04 21:16:05,955 [trainer.py] => progressive_lr: 0.01
2025-11-04 21:16:05,955 [trainer.py] => batch_size: 48
2025-11-04 21:16:05,955 [trainer.py] => weight_decay: 0.0005
2025-11-04 21:16:05,955 [trainer.py] => min_lr: 0
2025-11-04 21:16:05,955 [trainer.py] => ffn_num: 64
2025-11-04 21:16:05,955 [trainer.py] => optimizer: sgd
2025-11-04 21:16:05,955 [trainer.py] => vpt_type: shallow
2025-11-04 21:16:05,955 [trainer.py] => prompt_token_num: 5
2025-11-04 21:16:07,175 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-04 21:16:09,061 [trainer.py] => All params: 86988288
2025-11-04 21:16:09,063 [trainer.py] => Trainable params: 1189632
2025-11-04 21:16:09,063 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-04 23:08:07,774 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.174, Train_accy 94.80, Test_accy 99.10
2025-11-04 23:09:49,181 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-04 23:10:00,465 [trainer.py] => No NME accuracy.
2025-11-04 23:10:00,465 [trainer.py] => CNN: {'total': 98.9, '00-09': 98.9, 'old': 0, 'new': 98.9}
2025-11-04 23:10:00,465 [trainer.py] => CNN top1 curve: [98.9]
2025-11-04 23:10:00,465 [trainer.py] => CNN top5 curve: [100.0]

2025-11-04 23:10:00,465 [trainer.py] => Average Accuracy (CNN): 98.9 

2025-11-04 23:10:00,466 [trainer.py] => All params: 90885969
2025-11-04 23:10:00,467 [trainer.py] => Trainable params: 5087313
2025-11-04 23:10:00,467 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-05 01:15:24,755 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 80/80 => Loss 0.236, Train_accy 92.86, Test_accy 48.85
2025-11-05 01:17:50,748 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-05 01:19:45,042 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.051464653640985486
2025-11-05 01:21:42,384 [trainer.py] => No NME accuracy.
2025-11-05 01:21:42,385 [trainer.py] => CNN: {'total': 97.3, '00-09': 97.8, '10-19': 96.8, 'old': 97.8, 'new': 96.8}
2025-11-05 01:21:42,385 [trainer.py] => CNN top1 curve: [98.9, 97.3]
2025-11-05 01:21:42,385 [trainer.py] => CNN top5 curve: [100.0, 99.4]

2025-11-05 01:21:42,385 [trainer.py] => Average Accuracy (CNN): 98.1 

2025-11-05 01:21:42,385 [trainer.py] => All params: 90943649
2025-11-05 01:21:42,386 [trainer.py] => Trainable params: 1304993
2025-11-05 01:21:42,386 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 20-30
2025-11-05 15:23:05,824 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-05 15:23:05,824 [trainer.py] => prefix: reproduce
2025-11-05 15:23:05,824 [trainer.py] => dataset: cifar224
2025-11-05 15:23:05,824 [trainer.py] => memory_size: 0
2025-11-05 15:23:05,824 [trainer.py] => memory_per_class: 0
2025-11-05 15:23:05,824 [trainer.py] => fixed_memory: False
2025-11-05 15:23:05,824 [trainer.py] => shuffle: True
2025-11-05 15:23:05,824 [trainer.py] => init_cls: 10
2025-11-05 15:23:05,824 [trainer.py] => increment: 10
2025-11-05 15:23:05,824 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-05 15:23:05,824 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-05 15:23:05,824 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-05 15:23:05,824 [trainer.py] => seed: 1993
2025-11-05 15:23:05,824 [trainer.py] => Hidden: 5000
2025-11-05 15:23:05,824 [trainer.py] => rg: 0.1
2025-11-05 15:23:05,824 [trainer.py] => lambda_fkd: 1
2025-11-05 15:23:05,824 [trainer.py] => cali_weight: 1.0
2025-11-05 15:23:05,824 [trainer.py] => alpha: 0.999
2025-11-05 15:23:05,824 [trainer.py] => tuned_epoch: 1
2025-11-05 15:23:05,824 [trainer.py] => progreesive_epoch: 1
2025-11-05 15:23:05,824 [trainer.py] => init_lr: 0.01
2025-11-05 15:23:05,824 [trainer.py] => progressive_lr: 0.01
2025-11-05 15:23:05,824 [trainer.py] => batch_size: 48
2025-11-05 15:23:05,824 [trainer.py] => weight_decay: 0.0005
2025-11-05 15:23:05,824 [trainer.py] => min_lr: 0
2025-11-05 15:23:05,824 [trainer.py] => ffn_num: 64
2025-11-05 15:23:05,824 [trainer.py] => optimizer: sgd
2025-11-05 15:23:05,825 [trainer.py] => vpt_type: shallow
2025-11-05 15:23:05,825 [trainer.py] => prompt_token_num: 5
2025-11-05 15:23:07,030 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-05 15:23:09,053 [trainer.py] => All params: 86988288
2025-11-05 15:23:09,054 [trainer.py] => Trainable params: 1189632
2025-11-05 15:23:09,054 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-05 15:24:31,695 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 1/1 => Loss 2.119, Train_accy 58.56, Test_accy 87.90
2025-11-05 15:26:10,531 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-05 15:26:21,411 [trainer.py] => No NME accuracy.
2025-11-05 15:26:21,411 [trainer.py] => CNN: {'total': 97.5, '00-09': 97.5, 'old': 0, 'new': 97.5}
2025-11-05 15:26:21,412 [trainer.py] => CNN top1 curve: [97.5]
2025-11-05 15:26:21,412 [trainer.py] => CNN top5 curve: [99.9]

2025-11-05 15:26:21,412 [trainer.py] => Average Accuracy (CNN): 97.5 

2025-11-05 15:26:21,412 [trainer.py] => All params: 90885969
2025-11-05 15:26:21,413 [trainer.py] => Trainable params: 5087313
2025-11-05 15:26:21,413 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-05 15:27:53,936 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 1/1 => Loss 2.214, Train_accy 50.80, Test_accy 34.80
2025-11-05 15:29:21,249 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-05 15:29:21,249 [trainer.py] => prefix: reproduce
2025-11-05 15:29:21,250 [trainer.py] => dataset: cifar224
2025-11-05 15:29:21,250 [trainer.py] => memory_size: 0
2025-11-05 15:29:21,250 [trainer.py] => memory_per_class: 0
2025-11-05 15:29:21,250 [trainer.py] => fixed_memory: False
2025-11-05 15:29:21,250 [trainer.py] => shuffle: True
2025-11-05 15:29:21,250 [trainer.py] => init_cls: 10
2025-11-05 15:29:21,250 [trainer.py] => increment: 10
2025-11-05 15:29:21,250 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-05 15:29:21,250 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-05 15:29:21,250 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-05 15:29:21,250 [trainer.py] => seed: 1993
2025-11-05 15:29:21,250 [trainer.py] => Hidden: 5000
2025-11-05 15:29:21,250 [trainer.py] => rg: 0.1
2025-11-05 15:29:21,250 [trainer.py] => lambda_fkd: 1
2025-11-05 15:29:21,250 [trainer.py] => cali_weight: 1.0
2025-11-05 15:29:21,250 [trainer.py] => alpha: 0.999
2025-11-05 15:29:21,250 [trainer.py] => tuned_epoch: 80
2025-11-05 15:29:21,250 [trainer.py] => progreesive_epoch: 80
2025-11-05 15:29:21,250 [trainer.py] => init_lr: 0.01
2025-11-05 15:29:21,250 [trainer.py] => progressive_lr: 0.01
2025-11-05 15:29:21,250 [trainer.py] => batch_size: 48
2025-11-05 15:29:21,250 [trainer.py] => weight_decay: 0.0005
2025-11-05 15:29:21,250 [trainer.py] => min_lr: 0
2025-11-05 15:29:21,250 [trainer.py] => ffn_num: 64
2025-11-05 15:29:21,250 [trainer.py] => optimizer: sgd
2025-11-05 15:29:21,250 [trainer.py] => vpt_type: shallow
2025-11-05 15:29:21,250 [trainer.py] => prompt_token_num: 5
2025-11-05 15:29:22,455 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-05 15:29:24,317 [trainer.py] => All params: 86988288
2025-11-05 15:29:24,317 [trainer.py] => Trainable params: 1189632
2025-11-05 15:29:24,317 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-05 17:21:29,623 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.174, Train_accy 94.80, Test_accy 99.10
2025-11-05 17:23:10,419 [adapt_ac_com_sdc_EMA_auto.py] => gamma 1000.0
2025-11-05 17:23:21,477 [trainer.py] => No NME accuracy.
2025-11-05 17:23:21,477 [trainer.py] => CNN: {'total': 98.9, '00-09': 98.9, 'old': 0, 'new': 98.9}
2025-11-05 17:23:21,477 [trainer.py] => CNN top1 curve: [98.9]
2025-11-05 17:23:21,477 [trainer.py] => CNN top5 curve: [100.0]

2025-11-05 17:23:21,477 [trainer.py] => Average Accuracy (CNN): 98.9 

2025-11-05 17:23:21,478 [trainer.py] => All params: 90885969
2025-11-05 17:23:21,478 [trainer.py] => Trainable params: 5087313
2025-11-05 17:23:21,478 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
