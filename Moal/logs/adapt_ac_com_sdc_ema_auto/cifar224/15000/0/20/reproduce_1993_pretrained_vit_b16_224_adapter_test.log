2025-11-16 03:12:16,176 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-16 03:12:16,176 [trainer.py] => prefix: reproduce
2025-11-16 03:12:16,176 [trainer.py] => dataset: cifar224
2025-11-16 03:12:16,176 [trainer.py] => memory_size: 0
2025-11-16 03:12:16,176 [trainer.py] => memory_per_class: 0
2025-11-16 03:12:16,176 [trainer.py] => fixed_memory: False
2025-11-16 03:12:16,176 [trainer.py] => shuffle: True
2025-11-16 03:12:16,176 [trainer.py] => init_cls: 20
2025-11-16 03:12:16,176 [trainer.py] => increment: 20
2025-11-16 03:12:16,176 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-16 03:12:16,176 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-16 03:12:16,176 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-16 03:12:16,176 [trainer.py] => seed: 1993
2025-11-16 03:12:16,176 [trainer.py] => Hidden: 15000
2025-11-16 03:12:16,176 [trainer.py] => rg: 0.1
2025-11-16 03:12:16,176 [trainer.py] => lambda_fkd: 1
2025-11-16 03:12:16,176 [trainer.py] => cali_weight: 1.0
2025-11-16 03:12:16,176 [trainer.py] => alpha: 0.999
2025-11-16 03:12:16,176 [trainer.py] => tuned_epoch: 80
2025-11-16 03:12:16,176 [trainer.py] => progreesive_epoch: 80
2025-11-16 03:12:16,176 [trainer.py] => init_lr: 0.01
2025-11-16 03:12:16,176 [trainer.py] => progressive_lr: 0.01
2025-11-16 03:12:16,176 [trainer.py] => batch_size: 48
2025-11-16 03:12:16,176 [trainer.py] => weight_decay: 0.0005
2025-11-16 03:12:16,176 [trainer.py] => min_lr: 0
2025-11-16 03:12:16,176 [trainer.py] => ffn_num: 64
2025-11-16 03:12:16,176 [trainer.py] => optimizer: sgd
2025-11-16 03:12:16,176 [trainer.py] => vpt_type: shallow
2025-11-16 03:12:16,176 [trainer.py] => prompt_token_num: 5
2025-11-16 03:12:17,427 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-16 03:12:19,418 [trainer.py] => All params: 86988288
2025-11-16 03:12:19,418 [trainer.py] => Trainable params: 1189632
2025-11-16 03:12:19,419 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-20
2025-11-16 07:01:18,455 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.303, Train_accy 90.90, Test_accy 97.70
2025-11-16 07:05:45,001 [adapt_ac_com_sdc_EMA_auto.py] => gamma 10000.0
2025-11-16 07:06:42,866 [trainer.py] => No NME accuracy.
2025-11-16 07:06:42,866 [trainer.py] => CNN: {'total': 97.75, '00-19': 97.75, 'old': 0, 'new': 97.75}
2025-11-16 07:06:42,866 [trainer.py] => CNN top1 curve: [97.75]
2025-11-16 07:06:42,866 [trainer.py] => CNN top5 curve: [99.7]

2025-11-16 07:06:42,867 [trainer.py] => Average Accuracy (CNN): 97.75 

2025-11-16 07:06:42,868 [trainer.py] => All params: 98823649
2025-11-16 07:06:42,869 [trainer.py] => Trainable params: 13024993
2025-11-16 07:06:42,869 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 20-40
2025-11-16 11:19:57,927 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 80/80 => Loss 0.294, Train_accy 91.36, Test_accy 49.02
2025-11-16 11:24:57,384 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-16 11:30:11,057 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04088229060173035
2025-11-16 11:41:40,680 [trainer.py] => No NME accuracy.
2025-11-16 11:41:40,680 [trainer.py] => CNN: {'total': 96.0, '00-19': 95.45, '20-39': 96.55, 'old': 95.45, 'new': 96.55}
2025-11-16 11:41:40,680 [trainer.py] => CNN top1 curve: [97.75, 96.0]
2025-11-16 11:41:40,680 [trainer.py] => CNN top5 curve: [99.7, 99.45]

2025-11-16 11:41:40,681 [trainer.py] => Average Accuracy (CNN): 96.875 

2025-11-16 11:41:40,682 [trainer.py] => All params: 99139009
2025-11-16 11:41:40,683 [trainer.py] => Trainable params: 1820353
2025-11-16 11:41:40,683 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 40-60
2025-11-16 16:22:06,084 [adapt_ac_com_sdc_EMA_auto.py] => Task 2, Epoch 80/80 => Loss 0.317, Train_accy 90.89, Test_accy 44.03
2025-11-16 16:27:03,257 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-16 16:32:01,548 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04504666742682457
2025-11-16 16:46:28,706 [trainer.py] => No NME accuracy.
2025-11-16 16:46:28,707 [trainer.py] => CNN: {'total': 94.33, '00-19': 93.65, '20-39': 94.25, '40-59': 95.1, 'old': 93.95, 'new': 95.1}
2025-11-16 16:46:28,707 [trainer.py] => CNN top1 curve: [97.75, 96.0, 94.33]
2025-11-16 16:46:28,707 [trainer.py] => CNN top5 curve: [99.7, 99.45, 99.33]

2025-11-16 16:46:28,707 [trainer.py] => Average Accuracy (CNN): 96.02666666666666 

2025-11-16 16:46:28,707 [trainer.py] => All params: 99454369
2025-11-16 16:46:28,708 [trainer.py] => Trainable params: 2135713
2025-11-16 16:46:28,708 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 60-80
2025-11-16 21:54:26,301 [adapt_ac_com_sdc_EMA_auto.py] => Task 3, Epoch 80/80 => Loss 0.348, Train_accy 90.47, Test_accy 42.20
2025-11-16 21:59:22,757 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-16 22:04:22,757 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.050896974265575406
2025-11-16 22:21:37,947 [trainer.py] => No NME accuracy.
2025-11-16 22:21:37,947 [trainer.py] => CNN: {'total': 92.32, '00-19': 92.55, '20-39': 93.7, '40-59': 91.3, '60-79': 91.75, 'old': 92.52, 'new': 91.75}
2025-11-16 22:21:37,947 [trainer.py] => CNN top1 curve: [97.75, 96.0, 94.33, 92.32]
2025-11-16 22:21:37,947 [trainer.py] => CNN top5 curve: [99.7, 99.45, 99.33, 99.1]

2025-11-16 22:21:37,947 [trainer.py] => Average Accuracy (CNN): 95.1 

2025-11-16 22:21:37,948 [trainer.py] => All params: 99769729
2025-11-16 22:21:37,948 [trainer.py] => Trainable params: 2451073
2025-11-16 22:21:37,948 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 80-100
2025-11-17 03:52:32,495 [adapt_ac_com_sdc_EMA_auto.py] => Task 4, Epoch 80/80 => Loss 0.498, Train_accy 82.64, Test_accy 36.86
2025-11-17 03:57:28,670 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-17 04:02:21,028 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04859479400515556
2025-11-17 04:22:18,426 [trainer.py] => No NME accuracy.
2025-11-17 04:22:18,426 [trainer.py] => CNN: {'total': 91.13, '00-19': 91.65, '20-39': 92.7, '40-59': 87.05, '60-79': 90.9, '80-99': 93.35, 'old': 90.58, 'new': 93.35}
2025-11-17 04:22:18,426 [trainer.py] => CNN top1 curve: [97.75, 96.0, 94.33, 92.32, 91.13]
2025-11-17 04:22:18,426 [trainer.py] => CNN top5 curve: [99.7, 99.45, 99.33, 99.1, 98.77]

2025-11-17 04:22:18,426 [trainer.py] => Average Accuracy (CNN): 94.306 

2025-11-17 04:22:18,426 [trainer.py] => All History Accuracy (CNN): [[97.75], [95.45, 96.55], [93.65, 94.25, 95.1], [92.55, 93.7, 91.3, 91.75], [91.65, 92.7, 87.05, 90.9, 93.35]] 

