2025-11-27 11:23:10,716 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-27 11:23:10,717 [trainer.py] => prefix: reproduce
2025-11-27 11:23:10,717 [trainer.py] => dataset: cifar224
2025-11-27 11:23:10,717 [trainer.py] => memory_size: 0
2025-11-27 11:23:10,717 [trainer.py] => memory_per_class: 0
2025-11-27 11:23:10,717 [trainer.py] => fixed_memory: False
2025-11-27 11:23:10,717 [trainer.py] => shuffle: True
2025-11-27 11:23:10,717 [trainer.py] => init_cls: 10
2025-11-27 11:23:10,717 [trainer.py] => increment: 10
2025-11-27 11:23:10,717 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-27 11:23:10,717 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-27 11:23:10,717 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-27 11:23:10,717 [trainer.py] => seed: 1993
2025-11-27 11:23:10,717 [trainer.py] => Hidden: 15000
2025-11-27 11:23:10,717 [trainer.py] => rg: 0.1
2025-11-27 11:23:10,717 [trainer.py] => lambda_fkd: 1
2025-11-27 11:23:10,717 [trainer.py] => cali_weight: 1.0
2025-11-27 11:23:10,717 [trainer.py] => alpha: 0.999
2025-11-27 11:23:10,717 [trainer.py] => tuned_epoch: 80
2025-11-27 11:23:10,717 [trainer.py] => progreesive_epoch: 80
2025-11-27 11:23:10,717 [trainer.py] => init_lr: 0.01
2025-11-27 11:23:10,717 [trainer.py] => progressive_lr: 0.01
2025-11-27 11:23:10,717 [trainer.py] => batch_size: 48
2025-11-27 11:23:10,717 [trainer.py] => weight_decay: 0.0005
2025-11-27 11:23:10,717 [trainer.py] => min_lr: 0
2025-11-27 11:23:10,717 [trainer.py] => ffn_num: 64
2025-11-27 11:23:10,717 [trainer.py] => optimizer: sgd
2025-11-27 11:23:10,717 [trainer.py] => vpt_type: shallow
2025-11-27 11:23:10,717 [trainer.py] => prompt_token_num: 5
2025-11-27 11:23:11,968 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-27 11:23:13,863 [trainer.py] => All params: 86988288
2025-11-27 11:23:13,864 [trainer.py] => Trainable params: 1189632
2025-11-27 11:23:13,864 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-27 13:15:49,393 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.174, Train_accy 94.80, Test_accy 99.10
2025-11-27 13:18:01,138 [adapt_ac_com_sdc_EMA_auto.py] => gamma 10000.0
2025-11-27 13:18:37,212 [trainer.py] => No NME accuracy.
2025-11-27 13:18:37,212 [trainer.py] => CNN: {'total': 99.1, '00-09': 99.1, 'old': 0, 'new': 99.1}
2025-11-27 13:18:37,213 [trainer.py] => CNN top1 curve: [99.1]
2025-11-27 13:18:37,213 [trainer.py] => CNN top5 curve: [100.0]

2025-11-27 13:18:37,213 [trainer.py] => Average Accuracy (CNN): 99.1 

2025-11-27 13:18:37,213 [trainer.py] => All params: 98665969
2025-11-27 13:18:37,214 [trainer.py] => Trainable params: 12867313
2025-11-27 13:18:37,214 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-27 15:23:14,523 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 80/80 => Loss 0.264, Train_accy 91.80, Test_accy 48.85
2025-11-27 15:25:39,554 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-27 15:27:37,528 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.05476247701048851
2025-11-27 15:33:12,434 [trainer.py] => No NME accuracy.
2025-11-27 15:33:12,434 [trainer.py] => CNN: {'total': 97.25, '00-09': 97.7, '10-19': 96.8, 'old': 97.7, 'new': 96.8}
2025-11-27 15:33:12,434 [trainer.py] => CNN top1 curve: [99.1, 97.25]
2025-11-27 15:33:12,434 [trainer.py] => CNN top5 curve: [100.0, 99.75]

2025-11-27 15:33:12,434 [trainer.py] => Average Accuracy (CNN): 98.175 

2025-11-27 15:33:12,435 [trainer.py] => All params: 98823649
2025-11-27 15:33:12,435 [trainer.py] => Trainable params: 1504993
2025-11-27 15:33:12,436 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 20-30
2025-11-27 17:51:13,730 [adapt_ac_com_sdc_EMA_auto.py] => Task 2, Epoch 80/80 => Loss 0.154, Train_accy 95.46, Test_accy 44.83
2025-11-27 17:53:41,211 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-27 17:56:09,658 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04581643936038017
2025-11-27 18:03:16,258 [trainer.py] => No NME accuracy.
2025-11-27 18:03:16,258 [trainer.py] => CNN: {'total': 96.47, '00-09': 96.7, '10-19': 95.1, '20-29': 97.6, 'old': 95.9, 'new': 97.6}
2025-11-27 18:03:16,258 [trainer.py] => CNN top1 curve: [99.1, 97.25, 96.47]
2025-11-27 18:03:16,258 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.7]

2025-11-27 18:03:16,258 [trainer.py] => Average Accuracy (CNN): 97.60666666666667 

2025-11-27 18:03:16,259 [trainer.py] => All params: 98981329
2025-11-27 18:03:16,259 [trainer.py] => Trainable params: 1662673
2025-11-27 18:03:16,260 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 30-40
2025-11-27 20:36:15,117 [adapt_ac_com_sdc_EMA_auto.py] => Task 3, Epoch 80/80 => Loss 0.212, Train_accy 93.28, Test_accy 46.90
2025-11-27 20:38:41,985 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-27 20:41:09,576 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.052767731934785844
2025-11-27 20:49:45,790 [trainer.py] => No NME accuracy.
2025-11-27 20:49:45,790 [trainer.py] => CNN: {'total': 95.55, '00-09': 96.3, '10-19': 93.4, '20-29': 96.7, '30-39': 95.8, 'old': 95.47, 'new': 95.8}
2025-11-27 20:49:45,790 [trainer.py] => CNN top1 curve: [99.1, 97.25, 96.47, 95.55]
2025-11-27 20:49:45,790 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.7, 99.5]

2025-11-27 20:49:45,790 [trainer.py] => Average Accuracy (CNN): 97.0925 

2025-11-27 20:49:45,791 [trainer.py] => All params: 99139009
2025-11-27 20:49:45,792 [trainer.py] => Trainable params: 1820353
2025-11-27 20:49:45,792 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 40-50
2025-11-27 23:34:25,989 [adapt_ac_com_sdc_EMA_auto.py] => Task 4, Epoch 80/80 => Loss 0.157, Train_accy 95.88, Test_accy 41.12
2025-11-27 23:36:52,756 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-27 23:39:20,797 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.045599380254745484
2025-11-27 23:49:22,140 [trainer.py] => No NME accuracy.
2025-11-27 23:49:22,140 [trainer.py] => CNN: {'total': 94.4, '00-09': 94.7, '10-19': 92.6, '20-29': 95.4, '30-39': 94.1, '40-49': 95.2, 'old': 94.2, 'new': 95.2}
2025-11-27 23:49:22,140 [trainer.py] => CNN top1 curve: [99.1, 97.25, 96.47, 95.55, 94.4]
2025-11-27 23:49:22,140 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.7, 99.5, 99.34]

2025-11-27 23:49:22,140 [trainer.py] => Average Accuracy (CNN): 96.554 

2025-11-27 23:49:22,141 [trainer.py] => All params: 99296689
2025-11-27 23:49:22,141 [trainer.py] => Trainable params: 1978033
2025-11-27 23:49:22,141 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 50-60
2025-11-28 02:47:05,309 [adapt_ac_com_sdc_EMA_auto.py] => Task 5, Epoch 80/80 => Loss 0.207, Train_accy 93.70, Test_accy 44.90
2025-11-28 02:49:32,566 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-28 02:52:02,031 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04998179677128792
2025-11-28 03:03:31,348 [trainer.py] => No NME accuracy.
2025-11-28 03:03:31,348 [trainer.py] => CNN: {'total': 93.7, '00-09': 93.0, '10-19': 92.0, '20-29': 94.4, '30-39': 93.0, '40-49': 95.3, '50-59': 94.5, 'old': 93.54, 'new': 94.5}
2025-11-28 03:03:31,348 [trainer.py] => CNN top1 curve: [99.1, 97.25, 96.47, 95.55, 94.4, 93.7]
2025-11-28 03:03:31,349 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.7, 99.5, 99.34, 99.17]

2025-11-28 03:03:31,349 [trainer.py] => Average Accuracy (CNN): 96.07833333333333 

2025-11-28 03:03:31,349 [trainer.py] => All params: 99454369
2025-11-28 03:03:31,350 [trainer.py] => Trainable params: 2135713
2025-11-28 03:03:31,350 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 60-70
2025-11-28 06:14:46,862 [adapt_ac_com_sdc_EMA_auto.py] => Task 6, Epoch 80/80 => Loss 0.155, Train_accy 95.66, Test_accy 50.10
2025-11-28 06:17:13,588 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-28 06:19:45,713 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04876361486315727
2025-11-28 06:32:24,928 [trainer.py] => No NME accuracy.
2025-11-28 06:32:24,929 [trainer.py] => CNN: {'total': 92.99, '00-09': 91.0, '10-19': 90.4, '20-29': 94.4, '30-39': 92.2, '40-49': 94.2, '50-59': 93.1, '60-69': 95.6, 'old': 92.55, 'new': 95.6}
2025-11-28 06:32:24,929 [trainer.py] => CNN top1 curve: [99.1, 97.25, 96.47, 95.55, 94.4, 93.7, 92.99]
2025-11-28 06:32:24,929 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.7, 99.5, 99.34, 99.17, 99.09]

2025-11-28 06:32:24,929 [trainer.py] => Average Accuracy (CNN): 95.63714285714286 

2025-11-28 06:32:24,929 [trainer.py] => All params: 99612049
2025-11-28 06:32:24,930 [trainer.py] => Trainable params: 2293393
2025-11-28 06:32:24,930 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 70-80
2025-11-28 09:53:31,456 [adapt_ac_com_sdc_EMA_auto.py] => Task 7, Epoch 80/80 => Loss 0.226, Train_accy 92.92, Test_accy 30.29
2025-11-28 09:55:56,802 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-28 09:57:58,910 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.050192528307437895
2025-11-28 10:12:12,326 [trainer.py] => No NME accuracy.
2025-11-28 10:12:12,326 [trainer.py] => CNN: {'total': 91.09, '00-09': 90.3, '10-19': 90.4, '20-29': 94.5, '30-39': 91.5, '40-49': 90.7, '50-59': 88.5, '60-69': 95.4, '70-79': 87.4, 'old': 91.61, 'new': 87.4}
2025-11-28 10:12:12,326 [trainer.py] => CNN top1 curve: [99.1, 97.25, 96.47, 95.55, 94.4, 93.7, 92.99, 91.09]
2025-11-28 10:12:12,326 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.7, 99.5, 99.34, 99.17, 99.09, 98.88]

2025-11-28 10:12:12,326 [trainer.py] => Average Accuracy (CNN): 95.06875000000001 

2025-11-28 10:12:12,327 [trainer.py] => All params: 99769729
2025-11-28 10:12:12,327 [trainer.py] => Trainable params: 2451073
2025-11-28 10:12:12,327 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 80-90
2025-11-28 13:46:17,866 [adapt_ac_com_sdc_EMA_auto.py] => Task 8, Epoch 80/80 => Loss 0.197, Train_accy 94.14, Test_accy 35.99
2025-11-28 13:48:42,809 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-28 13:50:41,981 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.049620094388723376
2025-11-28 14:06:21,481 [trainer.py] => No NME accuracy.
2025-11-28 14:06:21,481 [trainer.py] => CNN: {'total': 90.46, '00-09': 89.0, '10-19': 90.1, '20-29': 93.1, '30-39': 90.4, '40-49': 86.2, '50-59': 86.4, '60-69': 93.9, '70-79': 90.6, '80-89': 94.4, 'old': 89.96, 'new': 94.4}
2025-11-28 14:06:21,481 [trainer.py] => CNN top1 curve: [99.1, 97.25, 96.47, 95.55, 94.4, 93.7, 92.99, 91.09, 90.46]
2025-11-28 14:06:21,481 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.7, 99.5, 99.34, 99.17, 99.09, 98.88, 98.81]

2025-11-28 14:06:21,481 [trainer.py] => Average Accuracy (CNN): 94.55666666666667 

2025-11-28 14:06:21,482 [trainer.py] => All params: 99927409
2025-11-28 14:06:21,483 [trainer.py] => Trainable params: 2608753
2025-11-28 14:06:21,483 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 90-100
2025-11-28 17:53:40,381 [adapt_ac_com_sdc_EMA_auto.py] => Task 9, Epoch 80/80 => Loss 0.225, Train_accy 93.48, Test_accy 38.28
2025-11-28 17:56:07,573 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-28 17:59:31,712 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.052672414153814316
2025-11-28 18:16:52,989 [trainer.py] => No NME accuracy.
2025-11-28 18:16:52,989 [trainer.py] => CNN: {'total': 90.29, '00-09': 87.9, '10-19': 89.3, '20-29': 93.0, '30-39': 91.3, '40-49': 86.6, '50-59': 85.6, '60-69': 93.4, '70-79': 88.3, '80-89': 94.2, '90-99': 93.3, 'old': 89.96, 'new': 93.3}
2025-11-28 18:16:52,989 [trainer.py] => CNN top1 curve: [99.1, 97.25, 96.47, 95.55, 94.4, 93.7, 92.99, 91.09, 90.46, 90.29]
2025-11-28 18:16:52,989 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.7, 99.5, 99.34, 99.17, 99.09, 98.88, 98.81, 98.66]

2025-11-28 18:16:52,989 [trainer.py] => Average Accuracy (CNN): 94.13000000000001 

2025-11-28 18:16:52,989 [trainer.py] => All History Accuracy (CNN): [[99.1], [97.7, 96.8], [96.7, 95.1, 97.6], [96.3, 93.4, 96.7, 95.8], [94.7, 92.6, 95.4, 94.1, 95.2], [93.0, 92.0, 94.4, 93.0, 95.3, 94.5], [91.0, 90.4, 94.4, 92.2, 94.2, 93.1, 95.6], [90.3, 90.4, 94.5, 91.5, 90.7, 88.5, 95.4, 87.4], [89.0, 90.1, 93.1, 90.4, 86.2, 86.4, 93.9, 90.6, 94.4], [87.9, 89.3, 93.0, 91.3, 86.6, 85.6, 93.4, 88.3, 94.2, 93.3]] 

