2025-11-14 12:49:03,886 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-14 12:49:03,886 [trainer.py] => prefix: reproduce
2025-11-14 12:49:03,886 [trainer.py] => dataset: cifar224
2025-11-14 12:49:03,886 [trainer.py] => memory_size: 0
2025-11-14 12:49:03,886 [trainer.py] => memory_per_class: 0
2025-11-14 12:49:03,886 [trainer.py] => fixed_memory: False
2025-11-14 12:49:03,886 [trainer.py] => shuffle: True
2025-11-14 12:49:03,886 [trainer.py] => init_cls: 20
2025-11-14 12:49:03,886 [trainer.py] => increment: 20
2025-11-14 12:49:03,886 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-14 12:49:03,886 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-14 12:49:03,886 [trainer.py] => device: [device(type='cuda', index=3)]
2025-11-14 12:49:03,886 [trainer.py] => seed: 1993
2025-11-14 12:49:03,886 [trainer.py] => Hidden: 3000
2025-11-14 12:49:03,886 [trainer.py] => rg: 0.1
2025-11-14 12:49:03,886 [trainer.py] => lambda_fkd: 1
2025-11-14 12:49:03,886 [trainer.py] => cali_weight: 1.0
2025-11-14 12:49:03,886 [trainer.py] => alpha: 0.999
2025-11-14 12:49:03,886 [trainer.py] => tuned_epoch: 80
2025-11-14 12:49:03,886 [trainer.py] => progreesive_epoch: 80
2025-11-14 12:49:03,886 [trainer.py] => init_lr: 0.01
2025-11-14 12:49:03,886 [trainer.py] => progressive_lr: 0.01
2025-11-14 12:49:03,886 [trainer.py] => batch_size: 48
2025-11-14 12:49:03,886 [trainer.py] => weight_decay: 0.0005
2025-11-14 12:49:03,886 [trainer.py] => min_lr: 0
2025-11-14 12:49:03,886 [trainer.py] => ffn_num: 64
2025-11-14 12:49:03,886 [trainer.py] => optimizer: sgd
2025-11-14 12:49:03,887 [trainer.py] => vpt_type: shallow
2025-11-14 12:49:03,887 [trainer.py] => prompt_token_num: 5
2025-11-14 12:49:05,154 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-14 12:49:07,185 [trainer.py] => All params: 86988288
2025-11-14 12:49:07,186 [trainer.py] => Trainable params: 1189632
2025-11-14 12:49:07,186 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-20
2025-11-14 16:35:54,240 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.303, Train_accy 90.90, Test_accy 97.70
2025-11-14 16:39:15,368 [adapt_ac_com_sdc_EMA_auto.py] => gamma 10000.0
2025-11-14 16:39:45,287 [trainer.py] => No NME accuracy.
2025-11-14 16:39:45,287 [trainer.py] => CNN: {'total': 97.7, '00-19': 97.7, 'old': 0, 'new': 97.7}
2025-11-14 16:39:45,287 [trainer.py] => CNN top1 curve: [97.7]
2025-11-14 16:39:45,287 [trainer.py] => CNN top5 curve: [99.7]

2025-11-14 16:39:45,287 [trainer.py] => Average Accuracy (CNN): 97.7 

2025-11-14 16:39:45,288 [trainer.py] => All params: 89367649
2025-11-14 16:39:45,288 [trainer.py] => Trainable params: 3568993
2025-11-14 16:39:45,288 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 20-40
2025-11-14 20:53:03,487 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 80/80 => Loss 0.280, Train_accy 91.43, Test_accy 48.92
2025-11-14 20:57:58,549 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-14 21:03:02,898 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04087271082401275
2025-11-14 21:07:05,450 [trainer.py] => No NME accuracy.
2025-11-14 21:07:05,450 [trainer.py] => CNN: {'total': 95.82, '00-19': 95.15, '20-39': 96.5, 'old': 95.15, 'new': 96.5}
2025-11-14 21:07:05,450 [trainer.py] => CNN top1 curve: [97.7, 95.82]
2025-11-14 21:07:05,450 [trainer.py] => CNN top5 curve: [99.7, 99.5]

2025-11-14 21:07:05,450 [trainer.py] => Average Accuracy (CNN): 96.75999999999999 

2025-11-14 21:07:05,451 [trainer.py] => All params: 89443009
2025-11-14 21:07:05,451 [trainer.py] => Trainable params: 1340353
2025-11-14 21:07:05,451 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 40-60
2025-11-15 01:46:21,019 [adapt_ac_com_sdc_EMA_auto.py] => Task 2, Epoch 80/80 => Loss 0.314, Train_accy 90.80, Test_accy 44.52
2025-11-15 01:51:12,849 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-15 01:56:22,216 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04275254946947098
2025-11-15 02:00:42,456 [trainer.py] => No NME accuracy.
2025-11-15 02:00:42,456 [trainer.py] => CNN: {'total': 94.12, '00-19': 93.45, '20-39': 94.3, '40-59': 94.6, 'old': 93.88, 'new': 94.6}
2025-11-15 02:00:42,456 [trainer.py] => CNN top1 curve: [97.7, 95.82, 94.12]
2025-11-15 02:00:42,457 [trainer.py] => CNN top5 curve: [99.7, 99.5, 99.3]

2025-11-15 02:00:42,457 [trainer.py] => Average Accuracy (CNN): 95.88 

2025-11-15 02:00:42,457 [trainer.py] => All params: 89518369
2025-11-15 02:00:42,458 [trainer.py] => Trainable params: 1415713
2025-11-15 02:00:42,458 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 60-80
2025-11-15 07:02:25,151 [adapt_ac_com_sdc_EMA_auto.py] => Task 3, Epoch 80/80 => Loss 0.325, Train_accy 90.61, Test_accy 40.62
2025-11-15 07:07:16,158 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-15 07:12:58,403 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04598801153898239
2025-11-15 07:17:38,842 [trainer.py] => No NME accuracy.
2025-11-15 07:17:38,842 [trainer.py] => CNN: {'total': 91.84, '00-19': 92.35, '20-39': 93.8, '40-59': 89.75, '60-79': 91.45, 'old': 91.97, 'new': 91.45}
2025-11-15 07:17:38,842 [trainer.py] => CNN top1 curve: [97.7, 95.82, 94.12, 91.84]
2025-11-15 07:17:38,842 [trainer.py] => CNN top5 curve: [99.7, 99.5, 99.3, 99.19]

2025-11-15 07:17:38,842 [trainer.py] => Average Accuracy (CNN): 94.87 

2025-11-15 07:17:38,843 [trainer.py] => All params: 89593729
2025-11-15 07:17:38,843 [trainer.py] => Trainable params: 1491073
2025-11-15 07:17:38,843 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 80-100
2025-11-15 12:45:21,075 [adapt_ac_com_sdc_EMA_auto.py] => Task 4, Epoch 80/80 => Loss 0.319, Train_accy 91.15, Test_accy 34.20
2025-11-15 12:50:14,677 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-15 12:54:30,350 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04453285667300224
2025-11-15 12:59:34,686 [trainer.py] => No NME accuracy.
2025-11-15 12:59:34,687 [trainer.py] => CNN: {'total': 90.6, '00-19': 91.4, '20-39': 92.55, '40-59': 86.8, '60-79': 89.9, '80-99': 92.35, 'old': 90.16, 'new': 92.35}
2025-11-15 12:59:34,687 [trainer.py] => CNN top1 curve: [97.7, 95.82, 94.12, 91.84, 90.6]
2025-11-15 12:59:34,687 [trainer.py] => CNN top5 curve: [99.7, 99.5, 99.3, 99.19, 98.87]

2025-11-15 12:59:34,687 [trainer.py] => Average Accuracy (CNN): 94.016 

2025-11-15 12:59:34,687 [trainer.py] => All History Accuracy (CNN): [[97.7], [95.15, 96.5], [93.45, 94.3, 94.6], [92.35, 93.8, 89.75, 91.45], [91.4, 92.55, 86.8, 89.9, 92.35]] 

