2025-11-13 09:37:00,514 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-13 09:37:00,514 [trainer.py] => prefix: reproduce
2025-11-13 09:37:00,514 [trainer.py] => dataset: cifar224
2025-11-13 09:37:00,514 [trainer.py] => memory_size: 0
2025-11-13 09:37:00,514 [trainer.py] => memory_per_class: 0
2025-11-13 09:37:00,514 [trainer.py] => fixed_memory: False
2025-11-13 09:37:00,514 [trainer.py] => shuffle: True
2025-11-13 09:37:00,514 [trainer.py] => init_cls: 10
2025-11-13 09:37:00,514 [trainer.py] => increment: 10
2025-11-13 09:37:00,514 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-13 09:37:00,514 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-13 09:37:00,514 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-13 09:37:00,514 [trainer.py] => seed: 1993
2025-11-13 09:37:00,514 [trainer.py] => Hidden: 20000
2025-11-13 09:37:00,514 [trainer.py] => rg: 0.1
2025-11-13 09:37:00,514 [trainer.py] => lambda_fkd: 1
2025-11-13 09:37:00,514 [trainer.py] => cali_weight: 1.0
2025-11-13 09:37:00,514 [trainer.py] => alpha: 0.999
2025-11-13 09:37:00,514 [trainer.py] => tuned_epoch: 80
2025-11-13 09:37:00,514 [trainer.py] => progreesive_epoch: 80
2025-11-13 09:37:00,514 [trainer.py] => init_lr: 0.01
2025-11-13 09:37:00,514 [trainer.py] => progressive_lr: 0.01
2025-11-13 09:37:00,514 [trainer.py] => batch_size: 48
2025-11-13 09:37:00,514 [trainer.py] => weight_decay: 0.0005
2025-11-13 09:37:00,515 [trainer.py] => min_lr: 0
2025-11-13 09:37:00,515 [trainer.py] => ffn_num: 64
2025-11-13 09:37:00,515 [trainer.py] => optimizer: sgd
2025-11-13 09:37:00,515 [trainer.py] => vpt_type: shallow
2025-11-13 09:37:00,515 [trainer.py] => prompt_token_num: 5
2025-11-13 09:37:01,788 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-13 09:37:03,812 [trainer.py] => All params: 86988288
2025-11-13 09:37:03,813 [trainer.py] => Trainable params: 1189632
2025-11-13 09:37:03,813 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-10
2025-11-13 13:43:51,638 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.174, Train_accy 94.80, Test_accy 99.10
2025-11-13 13:47:39,941 [adapt_ac_com_sdc_EMA_auto.py] => gamma 10000.0
2025-11-13 13:49:02,146 [trainer.py] => No NME accuracy.
2025-11-13 13:49:02,146 [trainer.py] => CNN: {'total': 99.3, '00-09': 99.3, 'old': 0, 'new': 99.3}
2025-11-13 13:49:02,146 [trainer.py] => CNN top1 curve: [99.3]
2025-11-13 13:49:02,146 [trainer.py] => CNN top5 curve: [100.0]

2025-11-13 13:49:02,146 [trainer.py] => Average Accuracy (CNN): 99.3 

2025-11-13 13:49:02,147 [trainer.py] => All params: 102555969
2025-11-13 13:49:02,147 [trainer.py] => Trainable params: 16757313
2025-11-13 13:49:02,147 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 10-20
2025-11-13 15:54:57,559 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 80/80 => Loss 0.249, Train_accy 92.06, Test_accy 48.75
2025-11-13 15:57:24,667 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-13 15:59:54,662 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.05277541300654411
2025-11-13 16:10:26,766 [trainer.py] => No NME accuracy.
2025-11-13 16:10:26,766 [trainer.py] => CNN: {'total': 97.3, '00-09': 97.7, '10-19': 96.9, 'old': 97.7, 'new': 96.9}
2025-11-13 16:10:26,766 [trainer.py] => CNN top1 curve: [99.3, 97.3]
2025-11-13 16:10:26,766 [trainer.py] => CNN top5 curve: [100.0, 99.6]

2025-11-13 16:10:26,766 [trainer.py] => Average Accuracy (CNN): 98.3 

2025-11-13 16:10:26,767 [trainer.py] => All params: 102763649
2025-11-13 16:10:26,768 [trainer.py] => Trainable params: 1604993
2025-11-13 16:10:26,768 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 20-30
2025-11-13 18:29:54,915 [adapt_ac_com_sdc_EMA_auto.py] => Task 2, Epoch 80/80 => Loss 0.142, Train_accy 96.04, Test_accy 45.23
2025-11-13 18:32:21,932 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-13 18:34:51,468 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04791329923272133
2025-11-13 18:48:30,079 [trainer.py] => No NME accuracy.
2025-11-13 18:48:30,079 [trainer.py] => CNN: {'total': 96.57, '00-09': 96.7, '10-19': 95.0, '20-29': 98.0, 'old': 95.85, 'new': 98.0}
2025-11-13 18:48:30,080 [trainer.py] => CNN top1 curve: [99.3, 97.3, 96.57]
2025-11-13 18:48:30,080 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.53]

2025-11-13 18:48:30,080 [trainer.py] => Average Accuracy (CNN): 97.72333333333331 

2025-11-13 18:48:30,081 [trainer.py] => All params: 102971329
2025-11-13 18:48:30,081 [trainer.py] => Trainable params: 1812673
2025-11-13 18:48:30,081 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 30-40
2025-11-13 21:20:53,630 [adapt_ac_com_sdc_EMA_auto.py] => Task 3, Epoch 80/80 => Loss 0.206, Train_accy 93.64, Test_accy 46.85
2025-11-13 21:23:21,009 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-13 21:25:52,648 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.05424238619208336
2025-11-13 21:42:51,547 [trainer.py] => No NME accuracy.
2025-11-13 21:42:51,548 [trainer.py] => CNN: {'total': 95.48, '00-09': 95.9, '10-19': 94.0, '20-29': 96.5, '30-39': 95.5, 'old': 95.47, 'new': 95.5}
2025-11-13 21:42:51,548 [trainer.py] => CNN top1 curve: [99.3, 97.3, 96.57, 95.48]
2025-11-13 21:42:51,548 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.53, 99.45]

2025-11-13 21:42:51,548 [trainer.py] => Average Accuracy (CNN): 97.1625 

2025-11-13 21:42:51,549 [trainer.py] => All params: 103179009
2025-11-13 21:42:51,549 [trainer.py] => Trainable params: 2020353
2025-11-13 21:42:51,550 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 40-50
2025-11-14 00:28:07,147 [adapt_ac_com_sdc_EMA_auto.py] => Task 4, Epoch 80/80 => Loss 0.169, Train_accy 95.04, Test_accy 41.06
2025-11-14 00:30:33,001 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-14 00:32:59,847 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.045665439516305924
2025-11-14 00:52:53,806 [trainer.py] => No NME accuracy.
2025-11-14 00:52:53,807 [trainer.py] => CNN: {'total': 94.52, '00-09': 94.3, '10-19': 92.3, '20-29': 95.7, '30-39': 94.0, '40-49': 96.3, 'old': 94.08, 'new': 96.3}
2025-11-14 00:52:53,807 [trainer.py] => CNN top1 curve: [99.3, 97.3, 96.57, 95.48, 94.52]
2025-11-14 00:52:53,807 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.53, 99.45, 99.3]

2025-11-14 00:52:53,807 [trainer.py] => Average Accuracy (CNN): 96.63399999999999 

2025-11-14 00:52:53,808 [trainer.py] => All params: 103386689
2025-11-14 00:52:53,809 [trainer.py] => Trainable params: 2228033
2025-11-14 00:52:53,809 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 50-60
2025-11-14 03:49:22,982 [adapt_ac_com_sdc_EMA_auto.py] => Task 5, Epoch 80/80 => Loss 0.222, Train_accy 93.26, Test_accy 46.93
2025-11-14 03:51:49,313 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-14 03:54:16,393 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.05049747669696808
2025-11-14 04:17:13,896 [trainer.py] => No NME accuracy.
2025-11-14 04:17:13,896 [trainer.py] => CNN: {'total': 93.65, '00-09': 92.3, '10-19': 91.8, '20-29': 94.5, '30-39': 93.3, '40-49': 95.5, '50-59': 94.5, 'old': 93.48, 'new': 94.5}
2025-11-14 04:17:13,896 [trainer.py] => CNN top1 curve: [99.3, 97.3, 96.57, 95.48, 94.52, 93.65]
2025-11-14 04:17:13,896 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.53, 99.45, 99.3, 99.17]

2025-11-14 04:17:13,897 [trainer.py] => Average Accuracy (CNN): 96.13666666666666 

2025-11-14 04:17:13,897 [trainer.py] => All params: 103594369
2025-11-14 04:17:13,897 [trainer.py] => Trainable params: 2435713
2025-11-14 04:17:13,898 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 60-70
2025-11-14 07:26:43,598 [adapt_ac_com_sdc_EMA_auto.py] => Task 6, Epoch 80/80 => Loss 0.193, Train_accy 94.70, Test_accy 40.67
2025-11-14 07:29:09,574 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-14 07:31:36,359 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.05135382851958275
2025-11-14 07:57:28,670 [trainer.py] => No NME accuracy.
2025-11-14 07:57:28,670 [trainer.py] => CNN: {'total': 92.99, '00-09': 90.8, '10-19': 90.4, '20-29': 94.5, '30-39': 92.7, '40-49': 94.3, '50-59': 93.0, '60-69': 95.2, 'old': 92.62, 'new': 95.2}
2025-11-14 07:57:28,670 [trainer.py] => CNN top1 curve: [99.3, 97.3, 96.57, 95.48, 94.52, 93.65, 92.99]
2025-11-14 07:57:28,670 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.53, 99.45, 99.3, 99.17, 99.01]

2025-11-14 07:57:28,670 [trainer.py] => Average Accuracy (CNN): 95.68714285714285 

2025-11-14 07:57:28,671 [trainer.py] => All params: 103802049
2025-11-14 07:57:28,672 [trainer.py] => Trainable params: 2643393
2025-11-14 07:57:28,672 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 70-80
2025-11-14 11:19:04,596 [adapt_ac_com_sdc_EMA_auto.py] => Task 7, Epoch 80/80 => Loss 0.199, Train_accy 93.70, Test_accy 33.78
2025-11-14 11:21:28,979 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-14 11:23:32,406 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.0495292090177536
2025-11-14 11:52:51,938 [trainer.py] => No NME accuracy.
2025-11-14 11:52:51,939 [trainer.py] => CNN: {'total': 91.34, '00-09': 90.4, '10-19': 90.4, '20-29': 94.5, '30-39': 92.6, '40-49': 90.9, '50-59': 88.2, '60-69': 95.6, '70-79': 88.1, 'old': 91.8, 'new': 88.1}
2025-11-14 11:52:51,939 [trainer.py] => CNN top1 curve: [99.3, 97.3, 96.57, 95.48, 94.52, 93.65, 92.99, 91.34]
2025-11-14 11:52:51,939 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.53, 99.45, 99.3, 99.17, 99.01, 98.94]

2025-11-14 11:52:51,939 [trainer.py] => Average Accuracy (CNN): 95.14375 

2025-11-14 11:52:51,939 [trainer.py] => All params: 104009729
2025-11-14 11:52:51,940 [trainer.py] => Trainable params: 2851073
2025-11-14 11:52:51,940 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 80-90
2025-11-14 15:27:59,533 [adapt_ac_com_sdc_EMA_auto.py] => Task 8, Epoch 80/80 => Loss 0.199, Train_accy 94.22, Test_accy 31.24
2025-11-14 15:30:27,374 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-14 15:32:58,774 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.05079396989941597
2025-11-14 16:06:05,601 [trainer.py] => No NME accuracy.
2025-11-14 16:06:05,601 [trainer.py] => CNN: {'total': 90.46, '00-09': 88.0, '10-19': 89.8, '20-29': 93.5, '30-39': 91.2, '40-49': 87.1, '50-59': 85.5, '60-69': 93.7, '70-79': 90.8, '80-89': 94.5, 'old': 89.95, 'new': 94.5}
2025-11-14 16:06:05,601 [trainer.py] => CNN top1 curve: [99.3, 97.3, 96.57, 95.48, 94.52, 93.65, 92.99, 91.34, 90.46]
2025-11-14 16:06:05,601 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.53, 99.45, 99.3, 99.17, 99.01, 98.94, 98.63]

2025-11-14 16:06:05,602 [trainer.py] => Average Accuracy (CNN): 94.62333333333333 

2025-11-14 16:06:05,603 [trainer.py] => All params: 104217409
2025-11-14 16:06:05,604 [trainer.py] => Trainable params: 3058753
2025-11-14 16:06:05,604 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 90-100
2025-11-14 19:56:29,856 [adapt_ac_com_sdc_EMA_auto.py] => Task 9, Epoch 80/80 => Loss 0.223, Train_accy 93.68, Test_accy 32.14
2025-11-14 19:58:57,341 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-14 20:01:23,088 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.0583040297627449
2025-11-14 20:37:40,740 [trainer.py] => No NME accuracy.
2025-11-14 20:37:40,741 [trainer.py] => CNN: {'total': 89.98, '00-09': 87.0, '10-19': 89.0, '20-29': 93.0, '30-39': 91.7, '40-49': 85.9, '50-59': 84.9, '60-69': 93.3, '70-79': 87.8, '80-89': 93.8, '90-99': 93.4, 'old': 89.6, 'new': 93.4}
2025-11-14 20:37:40,741 [trainer.py] => CNN top1 curve: [99.3, 97.3, 96.57, 95.48, 94.52, 93.65, 92.99, 91.34, 90.46, 89.98]
2025-11-14 20:37:40,741 [trainer.py] => CNN top5 curve: [100.0, 99.6, 99.53, 99.45, 99.3, 99.17, 99.01, 98.94, 98.63, 98.41]

2025-11-14 20:37:40,741 [trainer.py] => Average Accuracy (CNN): 94.159 

2025-11-14 20:37:40,741 [trainer.py] => All History Accuracy (CNN): [[99.3], [97.7, 96.9], [96.7, 95.0, 98.0], [95.9, 94.0, 96.5, 95.5], [94.3, 92.3, 95.7, 94.0, 96.3], [92.3, 91.8, 94.5, 93.3, 95.5, 94.5], [90.8, 90.4, 94.5, 92.7, 94.3, 93.0, 95.2], [90.4, 90.4, 94.5, 92.6, 90.9, 88.2, 95.6, 88.1], [88.0, 89.8, 93.5, 91.2, 87.1, 85.5, 93.7, 90.8, 94.5], [87.0, 89.0, 93.0, 91.7, 85.9, 84.9, 93.3, 87.8, 93.8, 93.4]] 

