2025-11-16 03:12:36,257 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-16 03:12:36,257 [trainer.py] => prefix: reproduce
2025-11-16 03:12:36,257 [trainer.py] => dataset: cifar224
2025-11-16 03:12:36,257 [trainer.py] => memory_size: 0
2025-11-16 03:12:36,257 [trainer.py] => memory_per_class: 0
2025-11-16 03:12:36,257 [trainer.py] => fixed_memory: False
2025-11-16 03:12:36,257 [trainer.py] => shuffle: True
2025-11-16 03:12:36,257 [trainer.py] => init_cls: 20
2025-11-16 03:12:36,257 [trainer.py] => increment: 20
2025-11-16 03:12:36,257 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-16 03:12:36,257 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-16 03:12:36,257 [trainer.py] => device: [device(type='cuda', index=2)]
2025-11-16 03:12:36,257 [trainer.py] => seed: 1993
2025-11-16 03:12:36,257 [trainer.py] => Hidden: 20000
2025-11-16 03:12:36,257 [trainer.py] => rg: 0.1
2025-11-16 03:12:36,257 [trainer.py] => lambda_fkd: 1
2025-11-16 03:12:36,257 [trainer.py] => cali_weight: 1.0
2025-11-16 03:12:36,257 [trainer.py] => alpha: 0.999
2025-11-16 03:12:36,258 [trainer.py] => tuned_epoch: 80
2025-11-16 03:12:36,258 [trainer.py] => progreesive_epoch: 80
2025-11-16 03:12:36,258 [trainer.py] => init_lr: 0.01
2025-11-16 03:12:36,258 [trainer.py] => progressive_lr: 0.01
2025-11-16 03:12:36,258 [trainer.py] => batch_size: 48
2025-11-16 03:12:36,258 [trainer.py] => weight_decay: 0.0005
2025-11-16 03:12:36,258 [trainer.py] => min_lr: 0
2025-11-16 03:12:36,258 [trainer.py] => ffn_num: 64
2025-11-16 03:12:36,258 [trainer.py] => optimizer: sgd
2025-11-16 03:12:36,258 [trainer.py] => vpt_type: shallow
2025-11-16 03:12:36,258 [trainer.py] => prompt_token_num: 5
2025-11-16 03:12:37,518 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-16 03:12:39,473 [trainer.py] => All params: 86988288
2025-11-16 03:12:39,474 [trainer.py] => Trainable params: 1189632
2025-11-16 03:12:39,474 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-20
2025-11-16 06:57:28,976 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.303, Train_accy 90.90, Test_accy 97.70
2025-11-16 07:02:46,454 [adapt_ac_com_sdc_EMA_auto.py] => gamma 10000.0
2025-11-16 07:04:27,080 [trainer.py] => No NME accuracy.
2025-11-16 07:04:27,080 [trainer.py] => CNN: {'total': 98.05, '00-19': 98.05, 'old': 0, 'new': 98.05}
2025-11-16 07:04:27,080 [trainer.py] => CNN top1 curve: [98.05]
2025-11-16 07:04:27,080 [trainer.py] => CNN top5 curve: [99.65]

2025-11-16 07:04:27,080 [trainer.py] => Average Accuracy (CNN): 98.05 

2025-11-16 07:04:27,081 [trainer.py] => All params: 102763649
2025-11-16 07:04:27,081 [trainer.py] => Trainable params: 16964993
2025-11-16 07:04:27,081 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 20-40
2025-11-16 11:12:14,620 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 80/80 => Loss 0.450, Train_accy 81.94, Test_accy 44.12
2025-11-16 11:17:04,388 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-16 11:22:14,780 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04290687474608421
2025-11-16 11:43:27,116 [trainer.py] => No NME accuracy.
2025-11-16 11:43:27,117 [trainer.py] => CNN: {'total': 96.3, '00-19': 96.15, '20-39': 96.45, 'old': 96.15, 'new': 96.45}
2025-11-16 11:43:27,117 [trainer.py] => CNN top1 curve: [98.05, 96.3]
2025-11-16 11:43:27,117 [trainer.py] => CNN top5 curve: [99.65, 99.55]

2025-11-16 11:43:27,117 [trainer.py] => Average Accuracy (CNN): 97.175 

2025-11-16 11:43:27,117 [trainer.py] => All params: 103179009
2025-11-16 11:43:27,118 [trainer.py] => Trainable params: 2020353
2025-11-16 11:43:27,118 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 40-60
2025-11-16 16:19:27,076 [adapt_ac_com_sdc_EMA_auto.py] => Task 2, Epoch 80/80 => Loss 0.336, Train_accy 90.70, Test_accy 40.18
2025-11-16 16:24:15,995 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-16 16:29:12,950 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.044918513864278795
2025-11-16 16:56:43,618 [trainer.py] => No NME accuracy.
2025-11-16 16:56:43,618 [trainer.py] => CNN: {'total': 94.27, '00-19': 93.85, '20-39': 93.9, '40-59': 95.05, 'old': 93.88, 'new': 95.05}
2025-11-16 16:56:43,618 [trainer.py] => CNN top1 curve: [98.05, 96.3, 94.27]
2025-11-16 16:56:43,618 [trainer.py] => CNN top5 curve: [99.65, 99.55, 99.25]

2025-11-16 16:56:43,618 [trainer.py] => Average Accuracy (CNN): 96.20666666666666 

2025-11-16 16:56:43,619 [trainer.py] => All params: 103594369
2025-11-16 16:56:43,620 [trainer.py] => Trainable params: 2435713
2025-11-16 16:56:43,620 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 60-80
2025-11-16 21:56:44,409 [adapt_ac_com_sdc_EMA_auto.py] => Task 3, Epoch 80/80 => Loss 0.324, Train_accy 90.55, Test_accy 38.33
2025-11-16 22:01:33,816 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-16 22:06:38,764 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04503933876752853
2025-11-16 22:40:25,729 [trainer.py] => No NME accuracy.
2025-11-16 22:40:25,729 [trainer.py] => CNN: {'total': 92.31, '00-19': 92.65, '20-39': 93.85, '40-59': 90.85, '60-79': 91.9, 'old': 92.45, 'new': 91.9}
2025-11-16 22:40:25,729 [trainer.py] => CNN top1 curve: [98.05, 96.3, 94.27, 92.31]
2025-11-16 22:40:25,729 [trainer.py] => CNN top5 curve: [99.65, 99.55, 99.25, 99.06]

2025-11-16 22:40:25,729 [trainer.py] => Average Accuracy (CNN): 95.2325 

2025-11-16 22:40:25,730 [trainer.py] => All params: 104009729
2025-11-16 22:40:25,731 [trainer.py] => Trainable params: 2851073
2025-11-16 22:40:25,731 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 80-100
2025-11-17 04:06:18,602 [adapt_ac_com_sdc_EMA_auto.py] => Task 4, Epoch 80/80 => Loss 0.314, Train_accy 91.33, Test_accy 34.67
2025-11-17 04:11:07,943 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-17 04:16:01,598 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04281455773115158
2025-11-17 04:55:44,159 [trainer.py] => No NME accuracy.
2025-11-17 04:55:44,159 [trainer.py] => CNN: {'total': 91.14, '00-19': 91.5, '20-39': 92.55, '40-59': 87.2, '60-79': 91.15, '80-99': 93.3, 'old': 90.6, 'new': 93.3}
2025-11-17 04:55:44,159 [trainer.py] => CNN top1 curve: [98.05, 96.3, 94.27, 92.31, 91.14]
2025-11-17 04:55:44,159 [trainer.py] => CNN top5 curve: [99.65, 99.55, 99.25, 99.06, 98.84]

2025-11-17 04:55:44,159 [trainer.py] => Average Accuracy (CNN): 94.414 

2025-11-17 04:55:44,159 [trainer.py] => All History Accuracy (CNN): [[98.05], [96.15, 96.45], [93.85, 93.9, 95.05], [92.65, 93.85, 90.85, 91.9], [91.5, 92.55, 87.2, 91.15, 93.3]] 

