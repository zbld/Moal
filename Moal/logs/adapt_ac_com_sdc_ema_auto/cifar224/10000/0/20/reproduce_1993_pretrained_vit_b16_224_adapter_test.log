2025-11-16 03:11:51,062 [trainer.py] => config: exps/Moal_cifar224.json
2025-11-16 03:11:51,062 [trainer.py] => prefix: reproduce
2025-11-16 03:11:51,063 [trainer.py] => dataset: cifar224
2025-11-16 03:11:51,063 [trainer.py] => memory_size: 0
2025-11-16 03:11:51,063 [trainer.py] => memory_per_class: 0
2025-11-16 03:11:51,063 [trainer.py] => fixed_memory: False
2025-11-16 03:11:51,063 [trainer.py] => shuffle: True
2025-11-16 03:11:51,063 [trainer.py] => init_cls: 20
2025-11-16 03:11:51,063 [trainer.py] => increment: 20
2025-11-16 03:11:51,063 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-16 03:11:51,063 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-16 03:11:51,063 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-16 03:11:51,063 [trainer.py] => seed: 1993
2025-11-16 03:11:51,063 [trainer.py] => Hidden: 10000
2025-11-16 03:11:51,063 [trainer.py] => rg: 0.1
2025-11-16 03:11:51,063 [trainer.py] => lambda_fkd: 1
2025-11-16 03:11:51,063 [trainer.py] => cali_weight: 1.0
2025-11-16 03:11:51,063 [trainer.py] => alpha: 0.999
2025-11-16 03:11:51,063 [trainer.py] => tuned_epoch: 80
2025-11-16 03:11:51,063 [trainer.py] => progreesive_epoch: 80
2025-11-16 03:11:51,063 [trainer.py] => init_lr: 0.01
2025-11-16 03:11:51,063 [trainer.py] => progressive_lr: 0.01
2025-11-16 03:11:51,063 [trainer.py] => batch_size: 48
2025-11-16 03:11:51,063 [trainer.py] => weight_decay: 0.0005
2025-11-16 03:11:51,063 [trainer.py] => min_lr: 0
2025-11-16 03:11:51,063 [trainer.py] => ffn_num: 64
2025-11-16 03:11:51,063 [trainer.py] => optimizer: sgd
2025-11-16 03:11:51,063 [trainer.py] => vpt_type: shallow
2025-11-16 03:11:51,063 [trainer.py] => prompt_token_num: 5
2025-11-16 03:11:52,291 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2025-11-16 03:11:54,262 [trainer.py] => All params: 86988288
2025-11-16 03:11:54,263 [trainer.py] => Trainable params: 1189632
2025-11-16 03:11:54,263 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-20
2025-11-16 06:58:47,884 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.303, Train_accy 90.90, Test_accy 97.70
2025-11-16 07:02:44,430 [adapt_ac_com_sdc_EMA_auto.py] => gamma 10000.0
2025-11-16 07:03:28,037 [trainer.py] => No NME accuracy.
2025-11-16 07:03:28,037 [trainer.py] => CNN: {'total': 97.8, '00-19': 97.8, 'old': 0, 'new': 97.8}
2025-11-16 07:03:28,037 [trainer.py] => CNN top1 curve: [97.8]
2025-11-16 07:03:28,037 [trainer.py] => CNN top5 curve: [99.6]

2025-11-16 07:03:28,037 [trainer.py] => Average Accuracy (CNN): 97.8 

2025-11-16 07:03:28,038 [trainer.py] => All params: 94883649
2025-11-16 07:03:28,039 [trainer.py] => Trainable params: 9084993
2025-11-16 07:03:28,039 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 20-40
2025-11-16 11:15:49,681 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 80/80 => Loss 0.281, Train_accy 91.67, Test_accy 49.05
2025-11-16 11:20:42,835 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-16 11:25:48,226 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.042677014410495755
2025-11-16 11:31:59,720 [trainer.py] => No NME accuracy.
2025-11-16 11:31:59,720 [trainer.py] => CNN: {'total': 96.18, '00-19': 95.75, '20-39': 96.6, 'old': 95.75, 'new': 96.6}
2025-11-16 11:31:59,720 [trainer.py] => CNN top1 curve: [97.8, 96.18]
2025-11-16 11:31:59,720 [trainer.py] => CNN top5 curve: [99.6, 99.5]

2025-11-16 11:31:59,721 [trainer.py] => Average Accuracy (CNN): 96.99000000000001 

2025-11-16 11:31:59,721 [trainer.py] => All params: 95099009
2025-11-16 11:31:59,722 [trainer.py] => Trainable params: 1620353
2025-11-16 11:31:59,722 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 40-60
2025-11-16 16:10:06,283 [adapt_ac_com_sdc_EMA_auto.py] => Task 2, Epoch 80/80 => Loss 0.330, Train_accy 90.53, Test_accy 44.43
2025-11-16 16:15:01,546 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-16 16:19:51,679 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04562049749493599
2025-11-16 16:27:13,255 [trainer.py] => No NME accuracy.
2025-11-16 16:27:13,255 [trainer.py] => CNN: {'total': 94.33, '00-19': 93.85, '20-39': 94.4, '40-59': 94.75, 'old': 94.12, 'new': 94.75}
2025-11-16 16:27:13,255 [trainer.py] => CNN top1 curve: [97.8, 96.18, 94.33]
2025-11-16 16:27:13,255 [trainer.py] => CNN top5 curve: [99.6, 99.5, 99.32]

2025-11-16 16:27:13,255 [trainer.py] => Average Accuracy (CNN): 96.10333333333334 

2025-11-16 16:27:13,256 [trainer.py] => All params: 95314369
2025-11-16 16:27:13,256 [trainer.py] => Trainable params: 1835713
2025-11-16 16:27:13,256 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 60-80
2025-11-16 21:32:29,763 [adapt_ac_com_sdc_EMA_auto.py] => Task 3, Epoch 80/80 => Loss 0.335, Train_accy 90.81, Test_accy 41.51
2025-11-16 21:37:21,581 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-16 21:42:08,414 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.04599013590812683
2025-11-16 21:50:31,717 [trainer.py] => No NME accuracy.
2025-11-16 21:50:31,717 [trainer.py] => CNN: {'total': 92.31, '00-19': 92.5, '20-39': 94.25, '40-59': 90.45, '60-79': 92.05, 'old': 92.4, 'new': 92.05}
2025-11-16 21:50:31,717 [trainer.py] => CNN top1 curve: [97.8, 96.18, 94.33, 92.31]
2025-11-16 21:50:31,718 [trainer.py] => CNN top5 curve: [99.6, 99.5, 99.32, 99.05]

2025-11-16 21:50:31,718 [trainer.py] => Average Accuracy (CNN): 95.155 

2025-11-16 21:50:31,718 [trainer.py] => All params: 95529729
2025-11-16 21:50:31,719 [trainer.py] => Trainable params: 2051073
2025-11-16 21:50:31,719 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 80-100
2025-11-17 03:18:46,017 [adapt_ac_com_sdc_EMA_auto.py] => Task 4, Epoch 80/80 => Loss 0.401, Train_accy 86.76, Test_accy 34.62
2025-11-17 03:23:39,908 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-17 03:28:31,779 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.046952256619930265
2025-11-17 03:38:02,542 [trainer.py] => No NME accuracy.
2025-11-17 03:38:02,542 [trainer.py] => CNN: {'total': 91.07, '00-19': 91.55, '20-39': 92.7, '40-59': 86.95, '60-79': 90.55, '80-99': 93.6, 'old': 90.44, 'new': 93.6}
2025-11-17 03:38:02,542 [trainer.py] => CNN top1 curve: [97.8, 96.18, 94.33, 92.31, 91.07]
2025-11-17 03:38:02,542 [trainer.py] => CNN top5 curve: [99.6, 99.5, 99.32, 99.05, 98.88]

2025-11-17 03:38:02,542 [trainer.py] => Average Accuracy (CNN): 94.338 

2025-11-17 03:38:02,543 [trainer.py] => All History Accuracy (CNN): [[97.8], [95.75, 96.6], [93.85, 94.4, 94.75], [92.5, 94.25, 90.45, 92.05], [91.55, 92.7, 86.95, 90.55, 93.6]] 

