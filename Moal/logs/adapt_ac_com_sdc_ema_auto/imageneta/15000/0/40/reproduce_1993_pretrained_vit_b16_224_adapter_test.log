2025-11-12 08:25:27,183 [trainer.py] => config: exps/Moal_imageneta.json
2025-11-12 08:25:27,183 [trainer.py] => prefix: reproduce
2025-11-12 08:25:27,184 [trainer.py] => dataset: imageneta
2025-11-12 08:25:27,184 [trainer.py] => memory_size: 0
2025-11-12 08:25:27,184 [trainer.py] => memory_per_class: 0
2025-11-12 08:25:27,184 [trainer.py] => fixed_memory: False
2025-11-12 08:25:27,184 [trainer.py] => shuffle: True
2025-11-12 08:25:27,184 [trainer.py] => init_cls: 40
2025-11-12 08:25:27,184 [trainer.py] => increment: 40
2025-11-12 08:25:27,184 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-12 08:25:27,184 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-12 08:25:27,184 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-12 08:25:27,184 [trainer.py] => seed: 1993
2025-11-12 08:25:27,184 [trainer.py] => Hidden: 15000
2025-11-12 08:25:27,184 [trainer.py] => rg: 0.1
2025-11-12 08:25:27,184 [trainer.py] => lambda_fkd: 1
2025-11-12 08:25:27,184 [trainer.py] => cali_weight: 1.0
2025-11-12 08:25:27,184 [trainer.py] => alpha: 0.999
2025-11-12 08:25:27,184 [trainer.py] => tuned_epoch: 80
2025-11-12 08:25:27,184 [trainer.py] => progreesive_epoch: 80
2025-11-12 08:25:27,184 [trainer.py] => init_lr: 0.01
2025-11-12 08:25:27,184 [trainer.py] => progressive_lr: 0.01
2025-11-12 08:25:27,184 [trainer.py] => batch_size: 48
2025-11-12 08:25:27,184 [trainer.py] => weight_decay: 0.0005
2025-11-12 08:25:27,184 [trainer.py] => min_lr: 0
2025-11-12 08:25:27,184 [trainer.py] => ffn_num: 64
2025-11-12 08:25:27,184 [trainer.py] => optimizer: sgd
2025-11-12 08:25:27,184 [trainer.py] => vpt_type: shallow
2025-11-12 08:25:27,184 [trainer.py] => prompt_token_num: 5
2025-11-12 08:25:27,206 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-11-12 08:25:29,145 [trainer.py] => All params: 86988288
2025-11-12 08:25:29,146 [trainer.py] => Trainable params: 1189632
2025-11-12 08:25:29,146 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-40
2025-11-12 09:00:33,416 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.522, Train_accy 87.63, Test_accy 85.56
2025-11-12 09:02:02,469 [adapt_ac_com_sdc_EMA_auto.py] => gamma 10000.0
2025-11-12 09:02:45,344 [trainer.py] => No NME accuracy.
2025-11-12 09:02:45,344 [trainer.py] => CNN: {'total': 85.28, '00-39': 85.28, 'old': 0, 'new': 85.28}
2025-11-12 09:02:45,344 [trainer.py] => CNN top1 curve: [85.28]
2025-11-12 09:02:45,344 [trainer.py] => CNN top5 curve: [95.83]

2025-11-12 09:02:45,344 [trainer.py] => Average Accuracy (CNN): 85.28 

2025-11-12 09:02:45,345 [trainer.py] => All params: 99139009
2025-11-12 09:02:45,345 [trainer.py] => Trainable params: 13340353
2025-11-12 09:02:45,345 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 40-80
2025-11-12 09:38:53,545 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 80/80 => Loss 1.510, Train_accy 61.47, Test_accy 30.80
2025-11-12 09:39:54,355 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-12 09:40:56,066 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.1484254818696242
2025-11-12 09:42:57,288 [trainer.py] => No NME accuracy.
2025-11-12 09:42:57,288 [trainer.py] => CNN: {'total': 78.22, '00-39': 79.72, '40-79': 76.63, 'old': 79.72, 'new': 76.63}
2025-11-12 09:42:57,288 [trainer.py] => CNN top1 curve: [85.28, 78.22]
2025-11-12 09:42:57,288 [trainer.py] => CNN top5 curve: [95.83, 93.98]

2025-11-12 09:42:57,288 [trainer.py] => Average Accuracy (CNN): 81.75 

2025-11-12 09:42:57,289 [trainer.py] => All params: 99769729
2025-11-12 09:42:57,290 [trainer.py] => Trainable params: 2451073
2025-11-12 09:42:57,290 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 80-120
2025-11-12 10:17:37,873 [adapt_ac_com_sdc_EMA_auto.py] => Task 2, Epoch 80/80 => Loss 1.293, Train_accy 68.58, Test_accy 25.54
2025-11-12 10:18:21,091 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-12 10:18:52,023 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.27741997156824383
2025-11-12 10:20:42,090 [trainer.py] => No NME accuracy.
2025-11-12 10:20:42,090 [trainer.py] => CNN: {'total': 74.77, '00-39': 78.06, '40-79': 75.74, '80-119': 69.31, 'old': 76.93, 'new': 69.31}
2025-11-12 10:20:42,090 [trainer.py] => CNN top1 curve: [85.28, 78.22, 74.77]
2025-11-12 10:20:42,090 [trainer.py] => CNN top5 curve: [95.83, 93.98, 90.87]

2025-11-12 10:20:42,090 [trainer.py] => Average Accuracy (CNN): 79.42333333333333 

2025-11-12 10:20:42,091 [trainer.py] => All params: 100400449
2025-11-12 10:20:42,092 [trainer.py] => Trainable params: 3081793
2025-11-12 10:20:42,092 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 120-160
2025-11-12 10:59:31,886 [adapt_ac_com_sdc_EMA_auto.py] => Task 3, Epoch 80/80 => Loss 1.753, Train_accy 58.69, Test_accy 19.79
2025-11-12 11:00:16,486 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-12 11:00:49,490 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.2793800343419904
2025-11-12 11:03:11,941 [trainer.py] => No NME accuracy.
2025-11-12 11:03:11,941 [trainer.py] => CNN: {'total': 70.99, '00-39': 76.39, '40-79': 73.37, '80-119': 67.51, '120-159': 64.47, 'old': 72.82, 'new': 64.47}
2025-11-12 11:03:11,941 [trainer.py] => CNN top1 curve: [85.28, 78.22, 74.77, 70.99]
2025-11-12 11:03:11,941 [trainer.py] => CNN top5 curve: [95.83, 93.98, 90.87, 88.62]

2025-11-12 11:03:11,941 [trainer.py] => Average Accuracy (CNN): 77.315 

2025-11-12 11:03:11,942 [trainer.py] => All params: 101031169
2025-11-12 11:03:11,942 [trainer.py] => Trainable params: 3712513
2025-11-12 11:03:11,942 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 160-200
2025-11-12 11:45:59,559 [adapt_ac_com_sdc_EMA_auto.py] => Task 4, Epoch 80/80 => Loss 2.016, Train_accy 52.00, Test_accy 14.61
2025-11-12 11:46:45,903 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-12 11:47:18,944 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.24320793070576407
2025-11-12 11:50:17,433 [trainer.py] => No NME accuracy.
2025-11-12 11:50:17,433 [trainer.py] => CNN: {'total': 67.28, '00-39': 71.39, '40-79': 72.49, '80-119': 66.06, '120-159': 65.93, '160-199': 57.93, 'old': 69.31, 'new': 57.93}
2025-11-12 11:50:17,433 [trainer.py] => CNN top1 curve: [85.28, 78.22, 74.77, 70.99, 67.28]
2025-11-12 11:50:17,433 [trainer.py] => CNN top5 curve: [95.83, 93.98, 90.87, 88.62, 86.24]

2025-11-12 11:50:17,433 [trainer.py] => Average Accuracy (CNN): 75.30799999999999 

2025-11-12 11:50:17,433 [trainer.py] => All History Accuracy (CNN): [[85.28], [79.72, 76.63], [78.06, 75.74, 69.31], [76.39, 73.37, 67.51, 64.47], [71.39, 72.49, 66.06, 65.93, 57.93]] 

