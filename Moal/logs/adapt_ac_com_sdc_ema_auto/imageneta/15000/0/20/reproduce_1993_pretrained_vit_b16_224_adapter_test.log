2025-11-10 09:27:38,567 [trainer.py] => config: exps/Moal_imageneta.json
2025-11-10 09:27:38,568 [trainer.py] => prefix: reproduce
2025-11-10 09:27:38,568 [trainer.py] => dataset: imageneta
2025-11-10 09:27:38,568 [trainer.py] => memory_size: 0
2025-11-10 09:27:38,568 [trainer.py] => memory_per_class: 0
2025-11-10 09:27:38,568 [trainer.py] => fixed_memory: False
2025-11-10 09:27:38,568 [trainer.py] => shuffle: True
2025-11-10 09:27:38,568 [trainer.py] => init_cls: 20
2025-11-10 09:27:38,568 [trainer.py] => increment: 20
2025-11-10 09:27:38,568 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-10 09:27:38,568 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-10 09:27:38,568 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-10 09:27:38,568 [trainer.py] => seed: 1993
2025-11-10 09:27:38,568 [trainer.py] => Hidden: 15000
2025-11-10 09:27:38,568 [trainer.py] => rg: 0.1
2025-11-10 09:27:38,568 [trainer.py] => lambda_fkd: 1
2025-11-10 09:27:38,568 [trainer.py] => cali_weight: 1.0
2025-11-10 09:27:38,568 [trainer.py] => alpha: 0.999
2025-11-10 09:27:38,568 [trainer.py] => tuned_epoch: 80
2025-11-10 09:27:38,568 [trainer.py] => progreesive_epoch: 80
2025-11-10 09:27:38,568 [trainer.py] => init_lr: 0.01
2025-11-10 09:27:38,568 [trainer.py] => progressive_lr: 0.01
2025-11-10 09:27:38,568 [trainer.py] => batch_size: 48
2025-11-10 09:27:38,568 [trainer.py] => weight_decay: 0.0005
2025-11-10 09:27:38,568 [trainer.py] => min_lr: 0
2025-11-10 09:27:38,568 [trainer.py] => ffn_num: 64
2025-11-10 09:27:38,568 [trainer.py] => optimizer: sgd
2025-11-10 09:27:38,568 [trainer.py] => vpt_type: shallow
2025-11-10 09:27:38,568 [trainer.py] => prompt_token_num: 5
2025-11-10 09:27:38,590 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-11-10 09:27:40,484 [trainer.py] => All params: 86988288
2025-11-10 09:27:40,484 [trainer.py] => Trainable params: 1189632
2025-11-10 09:27:40,484 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-20
2025-11-10 09:45:10,095 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.468, Train_accy 90.07, Test_accy 88.00
2025-11-10 09:47:03,719 [adapt_ac_com_sdc_EMA_auto.py] => gamma 10000.0
2025-11-10 09:47:44,610 [trainer.py] => No NME accuracy.
2025-11-10 09:47:44,610 [trainer.py] => CNN: {'total': 85.14, '00-19': 85.14, 'old': 0, 'new': 85.14}
2025-11-10 09:47:44,610 [trainer.py] => CNN top1 curve: [85.14]
2025-11-10 09:47:44,610 [trainer.py] => CNN top5 curve: [98.29]

2025-11-10 09:47:44,610 [trainer.py] => Average Accuracy (CNN): 85.14 

2025-11-10 09:47:44,611 [trainer.py] => All params: 98823649
2025-11-10 09:47:44,611 [trainer.py] => Trainable params: 13024993
2025-11-10 09:47:44,611 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 20-40
2025-11-10 10:08:46,921 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 80/80 => Loss 1.249, Train_accy 67.23, Test_accy 35.56
2025-11-10 10:09:16,424 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-10 10:09:40,001 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.6319901579386228
2025-11-10 10:10:43,072 [trainer.py] => No NME accuracy.
2025-11-10 10:10:43,072 [trainer.py] => CNN: {'total': 83.33, '00-19': 79.43, '20-39': 87.03, 'old': 79.43, 'new': 87.03}
2025-11-10 10:10:43,072 [trainer.py] => CNN top1 curve: [85.14, 83.33]
2025-11-10 10:10:43,072 [trainer.py] => CNN top5 curve: [98.29, 95.83]

2025-11-10 10:10:43,072 [trainer.py] => Average Accuracy (CNN): 84.235 

2025-11-10 10:10:43,073 [trainer.py] => All params: 99139009
2025-11-10 10:10:43,073 [trainer.py] => Trainable params: 1820353
2025-11-10 10:10:43,073 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 40-60
2025-11-10 10:28:16,481 [adapt_ac_com_sdc_EMA_auto.py] => Task 2, Epoch 80/80 => Loss 1.157, Train_accy 72.80, Test_accy 31.30
2025-11-10 10:28:37,977 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-10 10:28:54,560 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 1.2555428651662974
2025-11-10 10:29:50,317 [trainer.py] => No NME accuracy.
2025-11-10 10:29:50,317 [trainer.py] => CNN: {'total': 81.09, '00-19': 81.14, '20-39': 84.32, '40-59': 75.86, 'old': 82.78, 'new': 75.86}
2025-11-10 10:29:50,317 [trainer.py] => CNN top1 curve: [85.14, 83.33, 81.09]
2025-11-10 10:29:50,317 [trainer.py] => CNN top5 curve: [98.29, 95.83, 94.96]

2025-11-10 10:29:50,317 [trainer.py] => Average Accuracy (CNN): 83.18666666666667 

2025-11-10 10:29:50,318 [trainer.py] => All params: 99454369
2025-11-10 10:29:50,318 [trainer.py] => Trainable params: 2135713
2025-11-10 10:29:50,318 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 60-80
2025-11-10 10:55:42,852 [adapt_ac_com_sdc_EMA_auto.py] => Task 3, Epoch 80/80 => Loss 0.978, Train_accy 73.21, Test_accy 29.94
2025-11-10 10:56:12,683 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-10 10:56:38,423 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.5230304138569892
2025-11-10 10:58:06,751 [trainer.py] => No NME accuracy.
2025-11-10 10:58:06,752 [trainer.py] => CNN: {'total': 77.51, '00-19': 77.14, '20-39': 81.08, '40-59': 74.14, '60-79': 76.58, 'old': 77.94, 'new': 76.58}
2025-11-10 10:58:06,752 [trainer.py] => CNN top1 curve: [85.14, 83.33, 81.09, 77.51]
2025-11-10 10:58:06,752 [trainer.py] => CNN top5 curve: [98.29, 95.83, 94.96, 92.84]

2025-11-10 10:58:06,752 [trainer.py] => Average Accuracy (CNN): 81.7675 

2025-11-10 10:58:06,752 [trainer.py] => All params: 99769729
2025-11-10 10:58:06,753 [trainer.py] => Trainable params: 2451073
2025-11-10 10:58:06,753 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 80-100
2025-11-10 11:20:39,904 [adapt_ac_com_sdc_EMA_auto.py] => Task 4, Epoch 80/80 => Loss 1.079, Train_accy 71.76, Test_accy 22.35
2025-11-10 11:21:01,861 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-10 11:21:18,525 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 1.2264413766141207
2025-11-10 11:22:39,824 [trainer.py] => No NME accuracy.
2025-11-10 11:22:39,824 [trainer.py] => CNN: {'total': 74.44, '00-19': 76.57, '20-39': 78.92, '40-59': 72.41, '60-79': 77.93, '80-99': 62.24, 'old': 76.93, 'new': 62.24}
2025-11-10 11:22:39,824 [trainer.py] => CNN top1 curve: [85.14, 83.33, 81.09, 77.51, 74.44]
2025-11-10 11:22:39,824 [trainer.py] => CNN top5 curve: [98.29, 95.83, 94.96, 92.84, 91.32]

2025-11-10 11:22:39,824 [trainer.py] => Average Accuracy (CNN): 80.30199999999999 

2025-11-10 11:22:39,825 [trainer.py] => All params: 100085089
2025-11-10 11:22:39,825 [trainer.py] => Trainable params: 2766433
2025-11-10 11:22:39,825 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 100-120
2025-11-10 11:47:08,188 [adapt_ac_com_sdc_EMA_auto.py] => Task 5, Epoch 80/80 => Loss 0.782, Train_accy 83.56, Test_accy 22.77
2025-11-10 11:47:29,908 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-10 11:47:46,475 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 1.272345075067484
2025-11-10 11:49:08,925 [trainer.py] => No NME accuracy.
2025-11-10 11:49:08,925 [trainer.py] => CNN: {'total': 72.21, '00-19': 72.57, '20-39': 80.54, '40-59': 68.1, '60-79': 74.77, '80-99': 62.24, '100-119': 70.15, 'old': 72.53, 'new': 70.15}
2025-11-10 11:49:08,925 [trainer.py] => CNN top1 curve: [85.14, 83.33, 81.09, 77.51, 74.44, 72.21]
2025-11-10 11:49:08,925 [trainer.py] => CNN top5 curve: [98.29, 95.83, 94.96, 92.84, 91.32, 90.26]

2025-11-10 11:49:08,925 [trainer.py] => Average Accuracy (CNN): 78.95333333333333 

2025-11-10 11:49:08,926 [trainer.py] => All params: 100400449
2025-11-10 11:49:08,926 [trainer.py] => Trainable params: 3081793
2025-11-10 11:49:08,926 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 120-140
2025-11-10 12:15:44,204 [adapt_ac_com_sdc_EMA_auto.py] => Task 6, Epoch 80/80 => Loss 1.120, Train_accy 73.10, Test_accy 16.59
2025-11-10 12:16:06,928 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-10 12:16:24,045 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 1.176829942950496
2025-11-10 12:18:06,393 [trainer.py] => No NME accuracy.
2025-11-10 12:18:06,393 [trainer.py] => CNN: {'total': 70.65, '00-19': 69.71, '20-39': 76.22, '40-59': 68.97, '60-79': 75.23, '80-99': 64.34, '100-119': 70.15, '120-139': 65.75, 'old': 71.38, 'new': 65.75}
2025-11-10 12:18:06,394 [trainer.py] => CNN top1 curve: [85.14, 83.33, 81.09, 77.51, 74.44, 72.21, 70.65]
2025-11-10 12:18:06,394 [trainer.py] => CNN top5 curve: [98.29, 95.83, 94.96, 92.84, 91.32, 90.26, 89.12]

2025-11-10 12:18:06,394 [trainer.py] => Average Accuracy (CNN): 77.76714285714286 

2025-11-10 12:18:06,394 [trainer.py] => All params: 100715809
2025-11-10 12:18:06,395 [trainer.py] => Trainable params: 3397153
2025-11-10 12:18:06,395 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 140-160
2025-11-10 12:46:15,345 [adapt_ac_com_sdc_EMA_auto.py] => Task 7, Epoch 80/80 => Loss 1.138, Train_accy 70.62, Test_accy 18.27
2025-11-10 12:46:37,650 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-10 12:46:53,802 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 1.2207952252140752
2025-11-10 12:48:52,244 [trainer.py] => No NME accuracy.
2025-11-10 12:48:52,245 [trainer.py] => CNN: {'total': 68.83, '00-19': 69.14, '20-39': 74.59, '40-59': 66.38, '60-79': 74.77, '80-99': 65.03, '100-119': 70.15, '120-139': 65.75, '140-159': 58.27, 'old': 70.03, 'new': 58.27}
2025-11-10 12:48:52,245 [trainer.py] => CNN top1 curve: [85.14, 83.33, 81.09, 77.51, 74.44, 72.21, 70.65, 68.83]
2025-11-10 12:48:52,245 [trainer.py] => CNN top5 curve: [98.29, 95.83, 94.96, 92.84, 91.32, 90.26, 89.12, 87.5]

2025-11-10 12:48:52,245 [trainer.py] => Average Accuracy (CNN): 76.65 

2025-11-10 12:48:52,245 [trainer.py] => All params: 101031169
2025-11-10 12:48:52,246 [trainer.py] => Trainable params: 3712513
2025-11-10 12:48:52,246 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 160-180
2025-11-10 13:19:53,994 [adapt_ac_com_sdc_EMA_auto.py] => Task 8, Epoch 80/80 => Loss 1.290, Train_accy 72.33, Test_accy 17.71
2025-11-10 13:20:17,930 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-10 13:20:35,760 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 1.1588986947618682
2025-11-10 13:22:51,980 [trainer.py] => No NME accuracy.
2025-11-10 13:22:51,980 [trainer.py] => CNN: {'total': 65.38, '00-19': 70.29, '20-39': 69.19, '40-59': 65.52, '60-79': 72.07, '80-99': 58.74, '100-119': 67.91, '120-139': 67.12, '140-159': 61.42, '160-179': 50.34, 'old': 67.15, 'new': 50.34}
2025-11-10 13:22:51,980 [trainer.py] => CNN top1 curve: [85.14, 83.33, 81.09, 77.51, 74.44, 72.21, 70.65, 68.83, 65.38]
2025-11-10 13:22:51,980 [trainer.py] => CNN top5 curve: [98.29, 95.83, 94.96, 92.84, 91.32, 90.26, 89.12, 87.5, 86.31]

2025-11-10 13:22:51,981 [trainer.py] => Average Accuracy (CNN): 75.39777777777778 

2025-11-10 13:22:51,981 [trainer.py] => All params: 101346529
2025-11-10 13:22:51,981 [trainer.py] => Trainable params: 4027873
2025-11-10 13:22:51,982 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 180-200
2025-11-10 13:54:35,128 [adapt_ac_com_sdc_EMA_auto.py] => Task 9, Epoch 80/80 => Loss 0.887, Train_accy 77.42, Test_accy 16.39
2025-11-10 13:54:58,148 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-10 13:55:13,561 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 1.3081708156837608
2025-11-10 13:57:25,658 [trainer.py] => No NME accuracy.
2025-11-10 13:57:25,659 [trainer.py] => CNN: {'total': 64.38, '00-19': 65.14, '20-39': 65.41, '40-59': 62.93, '60-79': 70.72, '80-99': 62.24, '100-119': 67.91, '120-139': 67.12, '140-159': 62.2, '160-179': 55.78, '180-199': 59.68, 'old': 64.8, 'new': 59.68}
2025-11-10 13:57:25,659 [trainer.py] => CNN top1 curve: [85.14, 83.33, 81.09, 77.51, 74.44, 72.21, 70.65, 68.83, 65.38, 64.38]
2025-11-10 13:57:25,659 [trainer.py] => CNN top5 curve: [98.29, 95.83, 94.96, 92.84, 91.32, 90.26, 89.12, 87.5, 86.31, 85.25]

2025-11-10 13:57:25,659 [trainer.py] => Average Accuracy (CNN): 74.296 

2025-11-10 13:57:25,659 [trainer.py] => All History Accuracy (CNN): [[85.14], [79.43, 87.03], [81.14, 84.32, 75.86], [77.14, 81.08, 74.14, 76.58], [76.57, 78.92, 72.41, 77.93, 62.24], [72.57, 80.54, 68.1, 74.77, 62.24, 70.15], [69.71, 76.22, 68.97, 75.23, 64.34, 70.15, 65.75], [69.14, 74.59, 66.38, 74.77, 65.03, 70.15, 65.75, 58.27], [70.29, 69.19, 65.52, 72.07, 58.74, 67.91, 67.12, 61.42, 50.34], [65.14, 65.41, 62.93, 70.72, 62.24, 67.91, 67.12, 62.2, 55.78, 59.68]] 

