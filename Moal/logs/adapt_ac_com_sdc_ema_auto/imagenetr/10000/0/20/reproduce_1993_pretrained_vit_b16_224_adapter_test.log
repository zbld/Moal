2025-11-17 12:38:23,913 [trainer.py] => config: exps/Moal_imagenetr.json
2025-11-17 12:38:23,913 [trainer.py] => prefix: reproduce
2025-11-17 12:38:23,913 [trainer.py] => dataset: imagenetr
2025-11-17 12:38:23,913 [trainer.py] => memory_size: 0
2025-11-17 12:38:23,913 [trainer.py] => memory_per_class: 0
2025-11-17 12:38:23,913 [trainer.py] => fixed_memory: False
2025-11-17 12:38:23,913 [trainer.py] => shuffle: True
2025-11-17 12:38:23,913 [trainer.py] => init_cls: 20
2025-11-17 12:38:23,913 [trainer.py] => increment: 20
2025-11-17 12:38:23,913 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-17 12:38:23,913 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-17 12:38:23,913 [trainer.py] => device: [device(type='cuda', index=3)]
2025-11-17 12:38:23,914 [trainer.py] => seed: 1993
2025-11-17 12:38:23,914 [trainer.py] => Hidden: 10000
2025-11-17 12:38:23,914 [trainer.py] => rg: 0.1
2025-11-17 12:38:23,914 [trainer.py] => lambda_fkd: 1
2025-11-17 12:38:23,914 [trainer.py] => cali_weight: 1.0
2025-11-17 12:38:23,914 [trainer.py] => alpha: 0.999
2025-11-17 12:38:23,914 [trainer.py] => tuned_epoch: 80
2025-11-17 12:38:23,914 [trainer.py] => progreesive_epoch: 80
2025-11-17 12:38:23,914 [trainer.py] => init_lr: 0.01
2025-11-17 12:38:23,914 [trainer.py] => progressive_lr: 0.01
2025-11-17 12:38:23,914 [trainer.py] => batch_size: 48
2025-11-17 12:38:23,914 [trainer.py] => weight_decay: 0.0005
2025-11-17 12:38:23,914 [trainer.py] => min_lr: 0
2025-11-17 12:38:23,914 [trainer.py] => ffn_num: 64
2025-11-17 12:38:23,914 [trainer.py] => optimizer: sgd
2025-11-17 12:38:23,914 [trainer.py] => vpt_type: shallow
2025-11-17 12:38:23,914 [trainer.py] => prompt_token_num: 5
2025-11-17 12:38:23,979 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-11-17 12:38:25,878 [trainer.py] => All params: 86988288
2025-11-17 12:38:25,878 [trainer.py] => Trainable params: 1189632
2025-11-17 12:38:25,879 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-20
2025-11-17 13:43:59,737 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.310, Train_accy 91.98, Test_accy 95.07
2025-11-17 13:45:19,776 [adapt_ac_com_sdc_EMA_auto.py] => gamma 10000.0
2025-11-17 13:45:47,733 [trainer.py] => No NME accuracy.
2025-11-17 13:45:47,733 [trainer.py] => CNN: {'total': 94.78, '00-19': 94.78, 'old': 0, 'new': 94.78}
2025-11-17 13:45:47,733 [trainer.py] => CNN top1 curve: [94.78]
2025-11-17 13:45:47,733 [trainer.py] => CNN top5 curve: [99.42]

2025-11-17 13:45:47,733 [trainer.py] => Average Accuracy (CNN): 94.78 

2025-11-17 13:45:47,734 [trainer.py] => All params: 94883649
2025-11-17 13:45:47,734 [trainer.py] => Trainable params: 9084993
2025-11-17 13:45:47,734 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 20-40
2025-11-17 14:55:06,523 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 80/80 => Loss 0.545, Train_accy 81.97, Test_accy 40.42
2025-11-17 14:56:29,566 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-17 14:57:48,224 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.061804949396547175
2025-11-17 14:59:35,166 [trainer.py] => No NME accuracy.
2025-11-17 14:59:35,166 [trainer.py] => CNN: {'total': 89.33, '00-19': 90.57, '20-39': 87.97, 'old': 90.57, 'new': 87.97}
2025-11-17 14:59:35,166 [trainer.py] => CNN top1 curve: [94.78, 89.33]
2025-11-17 14:59:35,166 [trainer.py] => CNN top5 curve: [99.42, 97.73]

2025-11-17 14:59:35,166 [trainer.py] => Average Accuracy (CNN): 92.055 

2025-11-17 14:59:35,167 [trainer.py] => All params: 95099009
2025-11-17 14:59:35,168 [trainer.py] => Trainable params: 1620353
2025-11-17 14:59:35,168 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 40-60
2025-11-17 16:13:11,492 [adapt_ac_com_sdc_EMA_auto.py] => Task 2, Epoch 80/80 => Loss 0.742, Train_accy 78.15, Test_accy 32.80
2025-11-17 16:14:28,199 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-17 16:15:39,258 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.07346651633369161
2025-11-17 16:17:38,598 [trainer.py] => No NME accuracy.
2025-11-17 16:17:38,598 [trainer.py] => CNN: {'total': 87.08, '00-19': 89.26, '20-39': 85.28, '40-59': 86.47, 'old': 87.36, 'new': 86.47}
2025-11-17 16:17:38,598 [trainer.py] => CNN top1 curve: [94.78, 89.33, 87.08]
2025-11-17 16:17:38,598 [trainer.py] => CNN top5 curve: [99.42, 97.73, 96.68]

2025-11-17 16:17:38,598 [trainer.py] => Average Accuracy (CNN): 90.39666666666666 

2025-11-17 16:17:38,599 [trainer.py] => All params: 95314369
2025-11-17 16:17:38,599 [trainer.py] => Trainable params: 1835713
2025-11-17 16:17:38,599 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 60-80
2025-11-17 17:37:21,713 [adapt_ac_com_sdc_EMA_auto.py] => Task 3, Epoch 80/80 => Loss 0.797, Train_accy 74.40, Test_accy 30.14
2025-11-17 17:38:37,846 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-17 17:39:45,924 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.07738768166821935
2025-11-17 17:41:57,269 [trainer.py] => No NME accuracy.
2025-11-17 17:41:57,269 [trainer.py] => CNN: {'total': 85.39, '00-19': 86.79, '20-39': 85.6, '40-59': 84.49, '60-79': 84.41, 'old': 85.68, 'new': 84.41}
2025-11-17 17:41:57,269 [trainer.py] => CNN top1 curve: [94.78, 89.33, 87.08, 85.39]
2025-11-17 17:41:57,269 [trainer.py] => CNN top5 curve: [99.42, 97.73, 96.68, 95.64]

2025-11-17 17:41:57,269 [trainer.py] => Average Accuracy (CNN): 89.145 

2025-11-17 17:41:57,270 [trainer.py] => All params: 95529729
2025-11-17 17:41:57,270 [trainer.py] => Trainable params: 2051073
2025-11-17 17:41:57,270 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 80-100
2025-11-17 19:05:52,516 [adapt_ac_com_sdc_EMA_auto.py] => Task 4, Epoch 80/80 => Loss 0.560, Train_accy 85.10, Test_accy 28.61
2025-11-17 19:07:04,670 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-17 19:08:10,420 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.08132423754405538
2025-11-17 19:10:31,906 [trainer.py] => No NME accuracy.
2025-11-17 19:10:31,906 [trainer.py] => CNN: {'total': 82.98, '00-19': 85.34, '20-39': 84.02, '40-59': 82.67, '60-79': 82.49, '80-99': 79.26, 'old': 83.71, 'new': 79.26}
2025-11-17 19:10:31,906 [trainer.py] => CNN top1 curve: [94.78, 89.33, 87.08, 85.39, 82.98]
2025-11-17 19:10:31,906 [trainer.py] => CNN top5 curve: [99.42, 97.73, 96.68, 95.64, 94.37]

2025-11-17 19:10:31,906 [trainer.py] => Average Accuracy (CNN): 87.912 

2025-11-17 19:10:31,907 [trainer.py] => All params: 95745089
2025-11-17 19:10:31,907 [trainer.py] => Trainable params: 2266433
2025-11-17 19:10:31,907 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 100-120
2025-11-17 20:52:11,042 [adapt_ac_com_sdc_EMA_auto.py] => Task 5, Epoch 80/80 => Loss 0.506, Train_accy 87.43, Test_accy 29.44
2025-11-17 20:53:37,714 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-17 20:54:57,906 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.06457567544242417
2025-11-17 20:58:12,673 [trainer.py] => No NME accuracy.
2025-11-17 20:58:12,673 [trainer.py] => CNN: {'total': 82.19, '00-19': 83.45, '20-39': 83.54, '40-59': 81.35, '60-79': 80.21, '80-99': 77.0, '100-119': 85.91, 'old': 81.37, 'new': 85.91}
2025-11-17 20:58:12,673 [trainer.py] => CNN top1 curve: [94.78, 89.33, 87.08, 85.39, 82.98, 82.19]
2025-11-17 20:58:12,673 [trainer.py] => CNN top5 curve: [99.42, 97.73, 96.68, 95.64, 94.37, 94.05]

2025-11-17 20:58:12,673 [trainer.py] => Average Accuracy (CNN): 86.95833333333333 

2025-11-17 20:58:12,674 [trainer.py] => All params: 95960449
2025-11-17 20:58:12,674 [trainer.py] => Trainable params: 2481793
2025-11-17 20:58:12,674 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 120-140
2025-11-17 22:37:10,710 [adapt_ac_com_sdc_EMA_auto.py] => Task 6, Epoch 80/80 => Loss 0.735, Train_accy 78.81, Test_accy 24.13
2025-11-17 22:38:22,094 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-17 22:39:23,241 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.09001534197811789
2025-11-17 22:42:15,265 [trainer.py] => No NME accuracy.
2025-11-17 22:42:15,265 [trainer.py] => CNN: {'total': 81.35, '00-19': 82.15, '20-39': 82.75, '40-59': 80.69, '60-79': 79.16, '80-99': 75.56, '100-119': 85.61, '120-139': 81.72, 'old': 81.29, 'new': 81.72}
2025-11-17 22:42:15,265 [trainer.py] => CNN top1 curve: [94.78, 89.33, 87.08, 85.39, 82.98, 82.19, 81.35]
2025-11-17 22:42:15,265 [trainer.py] => CNN top5 curve: [99.42, 97.73, 96.68, 95.64, 94.37, 94.05, 93.43]

2025-11-17 22:42:15,265 [trainer.py] => Average Accuracy (CNN): 86.15714285714286 

2025-11-17 22:42:15,266 [trainer.py] => All params: 96175809
2025-11-17 22:42:15,266 [trainer.py] => Trainable params: 2697153
2025-11-17 22:42:15,266 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 140-160
2025-11-18 00:44:35,415 [adapt_ac_com_sdc_EMA_auto.py] => Task 7, Epoch 80/80 => Loss 0.624, Train_accy 80.04, Test_accy 24.72
2025-11-18 00:46:06,828 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-18 00:47:32,086 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.07534784918769877
2025-11-18 00:51:14,700 [trainer.py] => No NME accuracy.
2025-11-18 00:51:14,700 [trainer.py] => CNN: {'total': 80.52, '00-19': 80.26, '20-39': 83.54, '40-59': 79.87, '60-79': 78.81, '80-99': 75.36, '100-119': 82.42, '120-139': 78.91, '140-159': 82.99, 'old': 80.09, 'new': 82.99}
2025-11-18 00:51:14,700 [trainer.py] => CNN top1 curve: [94.78, 89.33, 87.08, 85.39, 82.98, 82.19, 81.35, 80.52]
2025-11-18 00:51:14,700 [trainer.py] => CNN top5 curve: [99.42, 97.73, 96.68, 95.64, 94.37, 94.05, 93.43, 92.72]

2025-11-18 00:51:14,700 [trainer.py] => Average Accuracy (CNN): 85.4525 

2025-11-18 00:51:14,701 [trainer.py] => All params: 96391169
2025-11-18 00:51:14,702 [trainer.py] => Trainable params: 2912513
2025-11-18 00:51:14,702 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 160-180
2025-11-18 02:42:21,731 [adapt_ac_com_sdc_EMA_auto.py] => Task 8, Epoch 80/80 => Loss 0.614, Train_accy 85.57, Test_accy 22.97
2025-11-18 02:43:30,295 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-18 02:44:29,102 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.09399859626323749
2025-11-18 02:47:40,622 [trainer.py] => No NME accuracy.
2025-11-18 02:47:40,622 [trainer.py] => CNN: {'total': 80.17, '00-19': 79.68, '20-39': 83.23, '40-59': 78.71, '60-79': 79.51, '80-99': 74.54, '100-119': 82.88, '120-139': 79.09, '140-159': 82.44, '160-179': 79.29, 'old': 80.25, 'new': 79.29}
2025-11-18 02:47:40,622 [trainer.py] => CNN top1 curve: [94.78, 89.33, 87.08, 85.39, 82.98, 82.19, 81.35, 80.52, 80.17]
2025-11-18 02:47:40,622 [trainer.py] => CNN top5 curve: [99.42, 97.73, 96.68, 95.64, 94.37, 94.05, 93.43, 92.72, 92.03]

2025-11-18 02:47:40,622 [trainer.py] => Average Accuracy (CNN): 84.86555555555555 

2025-11-18 02:47:40,623 [trainer.py] => All params: 96606529
2025-11-18 02:47:40,624 [trainer.py] => Trainable params: 3127873
2025-11-18 02:47:40,624 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 180-200
2025-11-18 04:53:11,226 [adapt_ac_com_sdc_EMA_auto.py] => Task 9, Epoch 80/80 => Loss 0.478, Train_accy 87.89, Test_accy 21.58
2025-11-18 04:54:26,344 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-18 04:55:32,933 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.07580916365272149
2025-11-18 04:59:26,031 [trainer.py] => No NME accuracy.
2025-11-18 04:59:26,031 [trainer.py] => CNN: {'total': 79.17, '00-19': 80.26, '20-39': 81.33, '40-59': 77.72, '60-79': 78.28, '80-99': 73.31, '100-119': 81.36, '120-139': 78.56, '140-159': 79.84, '160-179': 77.41, '180-199': 81.52, 'old': 78.92, 'new': 81.52}
2025-11-18 04:59:26,031 [trainer.py] => CNN top1 curve: [94.78, 89.33, 87.08, 85.39, 82.98, 82.19, 81.35, 80.52, 80.17, 79.17]
2025-11-18 04:59:26,031 [trainer.py] => CNN top5 curve: [99.42, 97.73, 96.68, 95.64, 94.37, 94.05, 93.43, 92.72, 92.03, 91.83]

2025-11-18 04:59:26,031 [trainer.py] => Average Accuracy (CNN): 84.29599999999999 

2025-11-18 04:59:26,031 [trainer.py] => All History Accuracy (CNN): [[94.78], [90.57, 87.97], [89.26, 85.28, 86.47], [86.79, 85.6, 84.49, 84.41], [85.34, 84.02, 82.67, 82.49, 79.26], [83.45, 83.54, 81.35, 80.21, 77.0, 85.91], [82.15, 82.75, 80.69, 79.16, 75.56, 85.61, 81.72], [80.26, 83.54, 79.87, 78.81, 75.36, 82.42, 78.91, 82.99], [79.68, 83.23, 78.71, 79.51, 74.54, 82.88, 79.09, 82.44, 79.29], [80.26, 81.33, 77.72, 78.28, 73.31, 81.36, 78.56, 79.84, 77.41, 81.52]] 

