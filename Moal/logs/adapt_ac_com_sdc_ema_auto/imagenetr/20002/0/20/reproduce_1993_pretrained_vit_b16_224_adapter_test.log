2025-11-18 16:31:27,438 [trainer.py] => config: exps/Moal_imagenetr.json
2025-11-18 16:31:27,438 [trainer.py] => prefix: reproduce
2025-11-18 16:31:27,438 [trainer.py] => dataset: imagenetr
2025-11-18 16:31:27,438 [trainer.py] => memory_size: 0
2025-11-18 16:31:27,438 [trainer.py] => memory_per_class: 0
2025-11-18 16:31:27,438 [trainer.py] => fixed_memory: False
2025-11-18 16:31:27,438 [trainer.py] => shuffle: True
2025-11-18 16:31:27,438 [trainer.py] => init_cls: 20
2025-11-18 16:31:27,438 [trainer.py] => increment: 20
2025-11-18 16:31:27,438 [trainer.py] => model_name: adapt_ac_com_sdc_ema_auto
2025-11-18 16:31:27,438 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-18 16:31:27,438 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-18 16:31:27,438 [trainer.py] => seed: 1993
2025-11-18 16:31:27,438 [trainer.py] => Hidden: 20002
2025-11-18 16:31:27,438 [trainer.py] => rg: 0
2025-11-18 16:31:27,438 [trainer.py] => lambda_fkd: 0
2025-11-18 16:31:27,438 [trainer.py] => cali_weight: 0
2025-11-18 16:31:27,438 [trainer.py] => alpha: 0.999
2025-11-18 16:31:27,438 [trainer.py] => tuned_epoch: 80
2025-11-18 16:31:27,438 [trainer.py] => progreesive_epoch: 80
2025-11-18 16:31:27,438 [trainer.py] => init_lr: 0.01
2025-11-18 16:31:27,438 [trainer.py] => progressive_lr: 0.01
2025-11-18 16:31:27,438 [trainer.py] => batch_size: 48
2025-11-18 16:31:27,439 [trainer.py] => weight_decay: 0.0005
2025-11-18 16:31:27,439 [trainer.py] => min_lr: 0
2025-11-18 16:31:27,439 [trainer.py] => ffn_num: 64
2025-11-18 16:31:27,439 [trainer.py] => optimizer: sgd
2025-11-18 16:31:27,439 [trainer.py] => vpt_type: shallow
2025-11-18 16:31:27,439 [trainer.py] => prompt_token_num: 5
2025-11-18 16:31:27,504 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-11-18 16:31:29,511 [trainer.py] => All params: 86988288
2025-11-18 16:31:29,512 [trainer.py] => Trainable params: 1189632
2025-11-18 16:31:29,512 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 0-20
2025-11-18 17:37:34,212 [adapt_ac_com_sdc_EMA_auto.py] => Task 0, Epoch 80/80 => Loss 0.310, Train_accy 91.98, Test_accy 95.07
2025-11-18 17:41:37,083 [adapt_ac_com_sdc_EMA_auto.py] => gamma 10000.0
2025-11-18 17:43:41,977 [trainer.py] => No NME accuracy.
2025-11-18 17:43:41,977 [trainer.py] => CNN: {'total': 94.63, '00-19': 94.63, 'old': 0, 'new': 94.63}
2025-11-18 17:43:41,977 [trainer.py] => CNN top1 curve: [94.63]
2025-11-18 17:43:41,977 [trainer.py] => CNN top5 curve: [98.98]

2025-11-18 17:43:41,977 [trainer.py] => Average Accuracy (CNN): 94.63 

2025-11-18 17:43:41,979 [trainer.py] => All params: 102765225
2025-11-18 17:43:41,979 [trainer.py] => Trainable params: 16966569
2025-11-18 17:43:41,979 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 20-40
2025-11-18 18:52:45,675 [adapt_ac_com_sdc_EMA_auto.py] => Task 1, Epoch 80/80 => Loss 0.537, Train_accy 82.08, Test_accy 41.33
2025-11-18 18:54:07,595 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-18 18:55:24,929 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.06043540034080758
2025-11-18 19:01:01,877 [trainer.py] => No NME accuracy.
2025-11-18 19:01:01,877 [trainer.py] => CNN: {'total': 89.63, '00-19': 91.0, '20-39': 88.13, 'old': 91.0, 'new': 88.13}
2025-11-18 19:01:01,877 [trainer.py] => CNN top1 curve: [94.63, 89.63]
2025-11-18 19:01:01,877 [trainer.py] => CNN top5 curve: [98.98, 97.35]

2025-11-18 19:01:01,877 [trainer.py] => Average Accuracy (CNN): 92.13 

2025-11-18 19:01:01,878 [trainer.py] => All params: 103180625
2025-11-18 19:01:01,878 [trainer.py] => Trainable params: 2020433
2025-11-18 19:01:01,878 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 40-60
2025-11-18 20:14:10,851 [adapt_ac_com_sdc_EMA_auto.py] => Task 2, Epoch 80/80 => Loss 0.549, Train_accy 86.21, Test_accy 37.99
2025-11-18 20:15:26,525 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-18 20:16:34,412 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.06975342415748759
2025-11-18 20:23:40,985 [trainer.py] => No NME accuracy.
2025-11-18 20:23:40,985 [trainer.py] => CNN: {'total': 87.7, '00-19': 89.55, '20-39': 85.92, '40-59': 87.46, 'old': 87.81, 'new': 87.46}
2025-11-18 20:23:40,985 [trainer.py] => CNN top1 curve: [94.63, 89.63, 87.7]
2025-11-18 20:23:40,985 [trainer.py] => CNN top5 curve: [98.98, 97.35, 96.78]

2025-11-18 20:23:40,985 [trainer.py] => Average Accuracy (CNN): 90.65333333333332 

2025-11-18 20:23:40,986 [trainer.py] => All params: 103596025
2025-11-18 20:23:40,986 [trainer.py] => Trainable params: 2435833
2025-11-18 20:23:40,986 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 60-80
2025-11-18 21:43:21,007 [adapt_ac_com_sdc_EMA_auto.py] => Task 3, Epoch 80/80 => Loss 0.773, Train_accy 77.93, Test_accy 32.31
2025-11-18 21:44:35,512 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-18 21:45:43,172 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.07390798472839853
2025-11-18 21:53:45,969 [trainer.py] => No NME accuracy.
2025-11-18 21:53:45,969 [trainer.py] => CNN: {'total': 85.55, '00-19': 87.37, '20-39': 84.81, '40-59': 85.48, '60-79': 84.24, 'old': 85.94, 'new': 84.24}
2025-11-18 21:53:45,969 [trainer.py] => CNN top1 curve: [94.63, 89.63, 87.7, 85.55]
2025-11-18 21:53:45,969 [trainer.py] => CNN top5 curve: [98.98, 97.35, 96.78, 95.88]

2025-11-18 21:53:45,969 [trainer.py] => Average Accuracy (CNN): 89.3775 

2025-11-18 21:53:45,970 [trainer.py] => All params: 104011425
2025-11-18 21:53:45,970 [trainer.py] => Trainable params: 2851233
2025-11-18 21:53:45,970 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 80-100
2025-11-18 23:16:45,473 [adapt_ac_com_sdc_EMA_auto.py] => Task 4, Epoch 80/80 => Loss 0.513, Train_accy 87.13, Test_accy 31.76
2025-11-18 23:17:56,970 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-18 23:19:00,948 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.0755528551996301
2025-11-18 23:28:17,857 [trainer.py] => No NME accuracy.
2025-11-18 23:28:17,858 [trainer.py] => CNN: {'total': 83.22, '00-19': 86.21, '20-39': 82.91, '40-59': 83.33, '60-79': 81.96, '80-99': 80.7, 'old': 83.71, 'new': 80.7}
2025-11-18 23:28:17,858 [trainer.py] => CNN top1 curve: [94.63, 89.63, 87.7, 85.55, 83.22]
2025-11-18 23:28:17,858 [trainer.py] => CNN top5 curve: [98.98, 97.35, 96.78, 95.88, 94.41]

2025-11-18 23:28:17,858 [trainer.py] => Average Accuracy (CNN): 88.146 

2025-11-18 23:28:17,858 [trainer.py] => All params: 104426825
2025-11-18 23:28:17,859 [trainer.py] => Trainable params: 3266633
2025-11-18 23:28:17,859 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 100-120
2025-11-19 01:09:35,782 [adapt_ac_com_sdc_EMA_auto.py] => Task 5, Epoch 80/80 => Loss 0.462, Train_accy 87.73, Test_accy 31.14
2025-11-19 01:11:01,346 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-19 01:12:18,741 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.07110283359159691
2025-11-19 01:26:51,622 [trainer.py] => No NME accuracy.
2025-11-19 01:26:51,622 [trainer.py] => CNN: {'total': 82.0, '00-19': 83.6, '20-39': 82.12, '40-59': 81.68, '60-79': 78.81, '80-99': 78.23, '100-119': 86.06, 'old': 81.11, 'new': 86.06}
2025-11-19 01:26:51,622 [trainer.py] => CNN top1 curve: [94.63, 89.63, 87.7, 85.55, 83.22, 82.0]
2025-11-19 01:26:51,622 [trainer.py] => CNN top5 curve: [98.98, 97.35, 96.78, 95.88, 94.41, 94.1]

2025-11-19 01:26:51,622 [trainer.py] => Average Accuracy (CNN): 87.12166666666667 

2025-11-19 01:26:51,623 [trainer.py] => All params: 104842225
2025-11-19 01:26:51,623 [trainer.py] => Trainable params: 3682033
2025-11-19 01:26:51,623 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 120-140
2025-11-19 03:04:53,180 [adapt_ac_com_sdc_EMA_auto.py] => Task 6, Epoch 80/80 => Loss 0.605, Train_accy 84.27, Test_accy 26.84
2025-11-19 03:06:02,834 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-19 03:07:08,017 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.08891580806511669
2025-11-19 03:18:46,996 [trainer.py] => No NME accuracy.
2025-11-19 03:18:46,996 [trainer.py] => CNN: {'total': 81.89, '00-19': 83.16, '20-39': 81.49, '40-59': 81.52, '60-79': 80.56, '80-99': 77.41, '100-119': 85.91, '120-139': 81.72, 'old': 81.92, 'new': 81.72}
2025-11-19 03:18:46,996 [trainer.py] => CNN top1 curve: [94.63, 89.63, 87.7, 85.55, 83.22, 82.0, 81.89]
2025-11-19 03:18:46,996 [trainer.py] => CNN top5 curve: [98.98, 97.35, 96.78, 95.88, 94.41, 94.1, 93.21]

2025-11-19 03:18:46,996 [trainer.py] => Average Accuracy (CNN): 86.37428571428572 

2025-11-19 03:18:46,997 [trainer.py] => All params: 105257625
2025-11-19 03:18:46,997 [trainer.py] => Trainable params: 4097433
2025-11-19 03:18:46,997 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 140-160
2025-11-19 05:19:29,558 [adapt_ac_com_sdc_EMA_auto.py] => Task 7, Epoch 80/80 => Loss 0.600, Train_accy 84.98, Test_accy 30.79
2025-11-19 05:20:59,360 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-19 05:22:24,343 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.07086131769291898
2025-11-19 05:38:34,273 [trainer.py] => No NME accuracy.
2025-11-19 05:38:34,274 [trainer.py] => CNN: {'total': 81.08, '00-19': 80.99, '20-39': 82.28, '40-59': 80.36, '60-79': 79.68, '80-99': 76.39, '100-119': 82.73, '120-139': 79.26, '140-159': 84.91, 'old': 80.42, 'new': 84.91}
2025-11-19 05:38:34,274 [trainer.py] => CNN top1 curve: [94.63, 89.63, 87.7, 85.55, 83.22, 82.0, 81.89, 81.08]
2025-11-19 05:38:34,274 [trainer.py] => CNN top5 curve: [98.98, 97.35, 96.78, 95.88, 94.41, 94.1, 93.21, 92.27]

2025-11-19 05:38:34,274 [trainer.py] => Average Accuracy (CNN): 85.7125 

2025-11-19 05:38:34,274 [trainer.py] => All params: 105673025
2025-11-19 05:38:34,275 [trainer.py] => Trainable params: 4512833
2025-11-19 05:38:34,275 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 160-180
2025-11-19 07:27:57,159 [adapt_ac_com_sdc_EMA_auto.py] => Task 8, Epoch 80/80 => Loss 0.577, Train_accy 87.06, Test_accy 26.62
2025-11-19 07:29:01,486 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-19 07:30:05,685 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.09581706260259334
2025-11-19 07:43:32,286 [trainer.py] => No NME accuracy.
2025-11-19 07:43:32,286 [trainer.py] => CNN: {'total': 80.11, '00-19': 80.26, '20-39': 80.85, '40-59': 79.21, '60-79': 78.81, '80-99': 75.15, '100-119': 81.97, '120-139': 79.26, '140-159': 83.54, '160-179': 79.92, 'old': 80.13, 'new': 79.92}
2025-11-19 07:43:32,286 [trainer.py] => CNN top1 curve: [94.63, 89.63, 87.7, 85.55, 83.22, 82.0, 81.89, 81.08, 80.11]
2025-11-19 07:43:32,286 [trainer.py] => CNN top5 curve: [98.98, 97.35, 96.78, 95.88, 94.41, 94.1, 93.21, 92.27, 92.07]

2025-11-19 07:43:32,286 [trainer.py] => Average Accuracy (CNN): 85.09 

2025-11-19 07:43:32,287 [trainer.py] => All params: 106088425
2025-11-19 07:43:32,287 [trainer.py] => Trainable params: 4928233
2025-11-19 07:43:32,287 [adapt_ac_com_sdc_EMA_auto.py] => Learning on 180-200
2025-11-19 09:46:07,177 [adapt_ac_com_sdc_EMA_auto.py] => Task 9, Epoch 80/80 => Loss 0.552, Train_accy 83.08, Test_accy 22.45
2025-11-19 09:47:20,435 [adapt_ac_com_sdc_EMA_auto.py] => 开始 修正 prototype
2025-11-19 09:48:34,754 [adapt_ac_com_sdc_EMA_auto.py] => best_loss: 0.08100429469399516
2025-11-19 10:05:43,982 [trainer.py] => No NME accuracy.
2025-11-19 10:05:43,983 [trainer.py] => CNN: {'total': 79.43, '00-19': 80.12, '20-39': 80.7, '40-59': 78.88, '60-79': 78.11, '80-99': 74.33, '100-119': 80.0, '120-139': 78.56, '140-159': 81.21, '160-179': 77.62, '180-199': 82.9, 'old': 79.06, 'new': 82.9}
2025-11-19 10:05:43,983 [trainer.py] => CNN top1 curve: [94.63, 89.63, 87.7, 85.55, 83.22, 82.0, 81.89, 81.08, 80.11, 79.43]
2025-11-19 10:05:43,983 [trainer.py] => CNN top5 curve: [98.98, 97.35, 96.78, 95.88, 94.41, 94.1, 93.21, 92.27, 92.07, 91.75]

2025-11-19 10:05:43,983 [trainer.py] => Average Accuracy (CNN): 84.524 

2025-11-19 10:05:43,983 [trainer.py] => All History Accuracy (CNN): [[94.63], [91.0, 88.13], [89.55, 85.92, 87.46], [87.37, 84.81, 85.48, 84.24], [86.21, 82.91, 83.33, 81.96, 80.7], [83.6, 82.12, 81.68, 78.81, 78.23, 86.06], [83.16, 81.49, 81.52, 80.56, 77.41, 85.91, 81.72], [80.99, 82.28, 80.36, 79.68, 76.39, 82.73, 79.26, 84.91], [80.26, 80.85, 79.21, 78.81, 75.15, 81.97, 79.26, 83.54, 79.92], [80.12, 80.7, 78.88, 78.11, 74.33, 80.0, 78.56, 81.21, 77.62, 82.9]] 

